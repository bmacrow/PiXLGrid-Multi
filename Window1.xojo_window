#tag Window
Begin Window Window1
   BackColor       =   &c51535200
   Backdrop        =   0
   CloseButton     =   True
   Compatibility   =   ""
   Composite       =   False
   Frame           =   9
   FullScreen      =   False
   FullScreenButton=   False
   HasBackColor    =   False
   Height          =   700
   ImplicitInstance=   True
   LiveResize      =   True
   MacProcID       =   0
   MaxHeight       =   32000
   MaximizeButton  =   False
   MaxWidth        =   32000
   MenuBar         =   905261055
   MenuBarVisible  =   True
   MinHeight       =   700
   MinimizeButton  =   True
   MinWidth        =   1010
   Placement       =   0
   Resizeable      =   True
   Title           =   "Editor"
   Visible         =   True
   Width           =   1010
   Begin Canvas Canvas1
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   False
      Enabled         =   True
      EraseBackground =   True
      Height          =   392
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   20
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   0
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   False
      Top             =   20
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   960
   End
   Begin ScrollBar VerticalScrollBar
      AcceptFocus     =   True
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   392
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   980
      LineStep        =   1
      LiveScroll      =   True
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Maximum         =   100
      Minimum         =   0
      PageStep        =   20
      Scope           =   0
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   20
      Transparent     =   False
      Value           =   0
      Visible         =   True
      Width           =   15
   End
   Begin ScrollBar HorizontalScrollBar
      AcceptFocus     =   True
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   15
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   20
      LineStep        =   1
      LiveScroll      =   True
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   False
      Maximum         =   100
      Minimum         =   0
      PageStep        =   20
      Scope           =   0
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   412
      Transparent     =   False
      Value           =   0
      Visible         =   True
      Width           =   960
   End
   Begin UpDownArrows Scale
      AcceptFocus     =   False
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   22
      HelpTag         =   "Zoom in and out"
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   890
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   False
      Visible         =   True
      Width           =   14
   End
   Begin TextField OutH
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   77
      LimitText       =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Mask            =   ""
      Password        =   False
      ReadOnly        =   False
      Scope           =   0
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "1920"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   False
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   46
   End
   Begin TextField OutV
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   135
      LimitText       =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Mask            =   ""
      Password        =   False
      ReadOnly        =   False
      Scope           =   0
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "1080"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   False
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   46
   End
   Begin LabelClass totYlabel1
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   122
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "H"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   12
   End
   Begin LabelClass totYlabel2
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   186
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "V"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   14
   End
   Begin LabelClass Label10
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   22
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Canvas"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   47
   End
   Begin CheckBox stats
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   42
      HelpTag         =   "Display raster box on canvas"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   206
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   428
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   22
   End
   Begin LabelClass zoom
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   17
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   908
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   17
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "54%"
      TextAlign       =   1
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   451
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   39
   End
   Begin CheckBox Hscroll
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Horizontal scrolling line"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   441
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   12
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   20
   End
   Begin CheckBox Vscroll
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Vertical scrolling line"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   508
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   20
   End
   Begin Slider SpeedSlide
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   23
      HelpTag         =   "Adjust speed of cursor"
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   696
      LineStep        =   1
      LiveScroll      =   True
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Maximum         =   5
      Minimum         =   1
      PageStep        =   20
      Scope           =   0
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      TickStyle       =   "0"
      Top             =   653
      Transparent     =   False
      Value           =   1
      Visible         =   False
      Width           =   82
   End
   Begin LabelClass Label13
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   650
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Speed"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   41
   End
   Begin PushButton Live3
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Live Output"
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Display canvas on second monitor with optional moving cursor"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   903
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   86
   End
   Begin Slider SizeSlide
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   23
      HelpTag         =   "Adjust size of cursor"
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   814
      LineStep        =   1
      LiveScroll      =   True
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Maximum         =   10
      Minimum         =   1
      PageStep        =   20
      Scope           =   0
      TabIndex        =   19
      TabPanelIndex   =   0
      TabStop         =   True
      TickStyle       =   "0"
      Top             =   657
      Transparent     =   False
      Value           =   1
      Visible         =   False
      Width           =   82
   End
   Begin LabelClass Label15
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   783
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   20
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Size"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   28
   End
   Begin CheckBox CursorColour
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Toggle live cursor colour"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   582
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   21
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   20
   End
   Begin PushButton AddGrid
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Add Grid..."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "If selected; copy grid, otherwise copy last grid"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   22
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   76
   End
   Begin Listbox GridsList
      AutoDeactivate  =   True
      AutoHideScrollbars=   True
      Bold            =   False
      Border          =   True
      ColumnCount     =   16
      ColumnsResizable=   True
      ColumnWidths    =   "44,44,44,44,52,52,*,110,50,50,50,50,50,50,50,70"
      DataField       =   ""
      DataSource      =   ""
      DefaultRowHeight=   -1
      Enabled         =   True
      EnableDrag      =   False
      EnableDragReorder=   True
      GridLinesHorizontal=   0
      GridLinesVertical=   0
      HasHeading      =   True
      HeadingIndex    =   -1
      Height          =   132
      HelpTag         =   "Add multiple grids with individual offsets.\nEnter ## pixels or ##p for panel offsets. "
      Hierarchical    =   False
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   "tileX	tileY	cols	rows	OffsetX	OffsetY	Name	Background	Grid	Raster	TileIDs	Circle	Cross	Corner	Logo	ColourBars"
      Italic          =   False
      Left            =   22
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   False
      RequiresSelection=   False
      Scope           =   0
      ScrollbarHorizontal=   False
      ScrollBarVertical=   True
      SelectionType   =   1
      ShowDropIndicator=   False
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   False
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   513
      Transparent     =   False
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   969
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
   Begin Rectangle Rectangle2
      AutoDeactivate  =   True
      BorderWidth     =   1
      BottomRightColor=   &c51535200
      Enabled         =   True
      FillColor       =   &cFFFFFF00
      Height          =   1
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   20
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   3
      TabPanelIndex   =   0
      Top             =   472
      TopLeftColor    =   &c51535200
      Transparent     =   False
      Visible         =   True
      Width           =   969
   End
   Begin PushButton DeleteGrid
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Delete Grid"
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Remove slected grid"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   108
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   23
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   88
   End
   BeginSegmented SegmentedControl GridCanvas_select
      Enabled         =   True
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   777
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      MacControlStyle =   0
      Scope           =   0
      Segments        =   "Grid\n\nTrue\rCanvas\n\nFalse"
      SelectionType   =   0
      TabIndex        =   25
      TabPanelIndex   =   0
      Top             =   440
      Transparent     =   False
      Visible         =   True
      Width           =   104
   End
   Begin CheckBox originCursor
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   42
      HelpTag         =   "Display Top Left start point cursor and co-ordinates"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   273
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   26
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   428
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   22
   End
   Begin PushButton SaveList
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Save List..."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Save grid list as csv file"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   814
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   27
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   80
   End
   Begin PushButton LoadList
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Open List..."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Import grid list from csv file"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   906
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   28
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   80
   End
   Begin CheckBox alt_text
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Displays large grid name in centre of each grid"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   202
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   29
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   True
      Width           =   18
   End
   Begin PushButton SaveAsCanvas
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Save Canvas As.."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Save just the grid within the canvas if selected\notherwise save all grids within the canvas."
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   158
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   126
   End
   Begin Label deselectLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   15
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   90
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   30
      TabPanelIndex   =   0
      TabStop         =   False
      Text            =   "De-select for all grids"
      TextAlign       =   0
      TextColor       =   &cFF000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   679
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   135
   End
   Begin PushButton SaveAsGrid
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "Save All Grids As..."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Save just the grid if selected\notherwise save all grids."
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   27
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   31
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   126
   End
   Begin CheckBox Grid_Solo
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Mutes all other grids in canvas"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   292
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   0
      TabIndex        =   32
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   False
      Width           =   20
   End
   Begin Rectangle ColorPicker
      AutoDeactivate  =   True
      BorderWidth     =   0
      BottomRightColor=   &c00000000
      Enabled         =   True
      FillColor       =   &cDCB42200
      Height          =   26
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   308
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   33
      TabPanelIndex   =   0
      Top             =   478
      TopLeftColor    =   &c00000000
      Transparent     =   False
      Visible         =   True
      Width           =   26
   End
   Begin CheckBox GridColour
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Displays large grid name in centre of each grid"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   476
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   34
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   True
      Width           =   22
   End
   Begin TextField CanvasText
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   "Canvas Name..."
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   "Displays Canvas Name and Resolution"
      Index           =   -2147483648
      Italic          =   False
      Left            =   443
      LimitText       =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Mask            =   ""
      Password        =   False
      ReadOnly        =   False
      Scope           =   0
      TabIndex        =   24
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   False
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   193
   End
   Begin PopupMenu TextPos
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   23
      HelpTag         =   "Canvas stats position"
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   "Top Left\nTop Centre\nTop Right\nBottom Left\nBottom Centre\nBottom Right"
      Italic          =   False
      Left            =   638
      ListIndex       =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   35
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   444
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   118
   End
   Begin CheckBox MaskMode
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Turns all grids transparent on black background"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   373
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   0
      TabIndex        =   36
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   False
      Width           =   20
   End
   Begin PushButton AEexport
      AutoDeactivate  =   True
      Bold            =   False
      ButtonStyle     =   "0"
      Cancel          =   False
      Caption         =   "AE Export..."
      Default         =   False
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Creates an After Effects Script to generate canvas"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   710
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   37
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   94
   End
   Begin Rectangle Rectangle3
      AutoDeactivate  =   True
      BorderWidth     =   1
      BottomRightColor=   &c51535200
      Enabled         =   True
      FillColor       =   &cFFFFFF00
      Height          =   34
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   768
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   38
      TabPanelIndex   =   0
      Top             =   436
      TopLeftColor    =   &c51535200
      Transparent     =   False
      Visible         =   True
      Width           =   1
   End
   Begin PopupMenu col_alpha
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   "Display tile IDs as numbers, or letters and numbers"
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   "Numbers\nColumn Letters\nRow Letters"
      Italic          =   False
      Left            =   569
      ListIndex       =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      TabIndex        =   40
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   481
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   109
   End
   Begin CheckBox T_Canvas
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   42
      HelpTag         =   "Removes black background from canvas"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   342
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   0
      TabIndex        =   41
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   428
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   False
      Width           =   22
   End
   Begin LabelClass T_CanvasText
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   365
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   42
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Transparent\nBackground"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   431
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   76
   End
   Begin LabelClass originText
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   296
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   43
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Offset\nCursor"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   431
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   42
   End
   Begin LabelClass statsText
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   230
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   44
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Raster\nBox"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   431
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   42
   End
   Begin LabelClass Label19
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   225
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   45
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Large\nGrid Names"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   473
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   72
   End
   Begin LabelClass Label20
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   338
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   46
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Text\nColour"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   473
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   42
   End
   Begin CheckBox dropShadow
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   42
      HelpTag         =   "Add drop shadow to text"
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   389
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   0
      State           =   1
      TabIndex        =   47
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   470
      Transparent     =   False
      Underline       =   False
      Value           =   True
      Visible         =   True
      Width           =   22
   End
   Begin LabelClass Label21
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   414
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   48
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Drop\nShadow"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   473
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   52
   End
   Begin LabelClass Label22
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   37
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   499
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   True
      Scope           =   0
      Selectable      =   False
      TabIndex        =   49
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Colour\nGrid"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   473
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   52
   End
   Begin Timer updateTime
      Index           =   -2147483648
      LockedInPosition=   False
      Mode            =   1
      Period          =   500
      Scope           =   0
      TabPanelIndex   =   0
   End
   Begin medButton FitHbutton
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      Caption         =   "Fit H"
      DoubleBuffer    =   False
      Enabled         =   True
      EraseBackground =   True
      Height          =   17
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   908
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   50
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   432
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   39
   End
   Begin medButton OnetoOnebtn
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      Caption         =   "1:1"
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   True
      Height          =   17
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   948
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   51
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   450
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   39
   End
   Begin medButton FitVbutton
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      Caption         =   "Fit V"
      DoubleBuffer    =   False
      Enabled         =   True
      EraseBackground =   True
      Height          =   17
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   948
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Scope           =   0
      TabIndex        =   52
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   432
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   39
   End
   Begin LabelClass LabelClass01
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   309
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   53
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Grid Solo"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   62
   End
   Begin LabelClass LabelClass02
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   392
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   54
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Mask"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   41
   End
   Begin LabelClass LabelClass03
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   457
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   55
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "H scroll"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   49
   End
   Begin LabelClass LabelClass04
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   529
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   56
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "V scroll"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   53
   End
   Begin LabelClass LabelClass05
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   601
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   False
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   57
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Colour"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   653
      Transparent     =   True
      Underline       =   False
      Visible         =   False
      Width           =   53
   End
End
#tag EndWindow

#tag WindowCode
	#tag Event
		Sub Close()
		  If Not Preferences.Save Then
		    MsgBox("Could not save preferences.")
		  End If
		  
		  FileClose.Visible=false
		  
		  Window2.Close()
		  
		  quit
		End Sub
	#tag EndEvent

	#tag Event
		Function KeyDown(Key As String) As Boolean
		  'Select case asc(key)
		  'case  43
		  ''+ zoom in
		  'case 45
		  ''- zoom out
		  'case 72,104
		  ''FitH
		  'FitH()
		  'case 86,118
		  ''FitV
		  'FitV()
		  'case 70,102
		  ''1:1
		  'mScale=100
		  'Window1.Canvas1.Refresh
		  'zoom.Text=str(mScale)+"%"
		  '
		  'case 27
		  'Window2.FullScreen=false
		  '
		  'else
		  '
		  'end
		  
		  
		End Function
	#tag EndEvent

	#tag Event
		Sub Open()
		  #If DebugBuild Then
		    me.Title = "Editor - Debug Mode " + "v" +Str(App.MinorVersion) +"."  + Str(App.Version) +"-"+Str(App.NonReleaseVersion)
		  #endif
		  
		  If Not IsDarkMode Then
		    Self.HasBackColor = True
		    Self.BackColor = &c51535200
		  End
		  
		  maxWinHeight =Window1.MinHeight '842
		  maxWinWidth = Window1.MinWidth '1010
		  CanvasHmargin =maxWinWidth-Canvas1.Width '50
		  CanvasVMargin =maxWinHeight-Canvas1.Height '302
		  
		  me.left = screen(0).left
		  me.top = screen(0).top+50
		  
		  
		  rebuild=true
		  
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent

	#tag Event
		Sub Resizing()
		  'debug.listbox1.InsertRow("Resize")
		  'UpdateScreen()
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h0
		Sub AfterEffect(avecGrid as Boolean)
		  Dim f, f2 As folderitem
		  dim tos as textOutputStream
		  dim s as string
		  dim i, j as integer
		  dim Red,Green,Blue as Integer
		  
		  
		  
		  'show standard file selector
		  f= GetsaveFolderItem(ExtendScript.jsx,"AE script - "+CanvasText.text+".jsx")
		  if f = nil then exit sub                              'cancel clicked
		  
		  'create file
		  tos = f.CreateTextFile
		  if tos = nil then                                       'failed?
		    MsgBox("The file could not be created!")
		    exit sub
		  end if
		  
		  s = AE1 + Window1.OutH.Text +";" + chr(10) + "  var compH = " + Window1.OutV.text + AE1a + Preferences.AEduration+ AE1b + Preferences.AEframerate + AE2 + CanvasText.text +AE2a
		  
		  tos.WriteLine s.left(s.len-1)                'save line
		  
		  if GridsList.ListCount>0 then                   'if grid not empty
		    for i=0 to GridsList.ListCount-1            'for each row
		      
		      if Preferences.AErandom then
		        Red = Rnd * 255
		        Green = rnd() * 255
		        Blue = rnd() * 255
		      else
		        Red = 127
		        Green = 127
		        Blue = 127
		      end if
		      
		      dim gridWidth as Integer = val(GridsList.cell(i,0)) * val(GridsList.cell(i,2))
		      dim gridHeight as Integer = val(GridsList.cell(i,1)) * val(GridsList.cell(i,3))
		      s= "  var compW = " + str(gridWidth) + ";" + chr(10) + "  var compH = " + str(gridHeight) + AE3 + GridsList.Cell(i,6) +AE3a +str(Red)+"/255,"+str(Green)+"/255,"+str(Blue)+"/255"+AE3b
		      tos.WriteLine s.left(s.len-1)                'save line
		      
		      if withGrids then 
		        s = AE3c + "Grid-" +GridsList.Cell(i,6) + "-"+Str(gridWidth) + "x" +Str(gridHeight) +".png" + AE3d
		        tos.WriteLine s.left(s.len-1)                'save line
		      end if
		      
		      s = AE3e+ GridsList.cell(i,4) + "," + GridsList.cell(i,5) + "]);" + chr(10) + chr(10)
		      
		      tos.WriteLine s.left(s.len-1)                'save line
		    next
		    
		  end 
		  
		  
		  if avecGrid then
		    OutCanvasUpdate()
		    s= AE4+ "Canvas-Mask-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) + ".png" + AE4b +chr(10)
		    tos.WriteLine s.left(s.len-1)                'save line
		    
		    
		    s= AE4+ "Canvas-Cursor-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) + ".png" + AE4b +chr(10)
		    tos.WriteLine s.left(s.len-1)  
		    
		    
		  end
		  
		  s= "  canvas.openInViewer();"+  chr(10) + "  app.endUndoGroup();" +chr(10) + "}" + chr(10)
		  tos.WriteLine s.left(s.len-1)                'save line
		  
		  
		  tos.Close                                                 'close file
		  
		  
		  f = f.Parent
		  'MsgBox(f.NativePath)
		  
		  
		  if avecGrid then
		    
		    dim outpic as Picture
		    
		    for i = 0 to GridsList.ListCount-1
		      PicIndex = i
		      BuildGrid(PicIndex)
		      
		      f2 = GetFolderItem(f.NativePath +"/Grid-" +GridsList.Cell(i,6) + "-"+str(myPic.Width) + "x" +str(myPic.Height) +".png",3)
		      'MsgBox(f2.NativePath)
		      If f2 <> Nil Then
		        mypic.Save(f2, Picture.SaveAsPNG)
		      End If
		      
		    next
		    
		    OutCursor()
		    
		    f2 = GetFolderItem(f.NativePath +"/Canvas-Cursor-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) +".png",3)
		    
		    
		    If f2 <> Nil Then
		      OutCanvas.Save(f2, Picture.SaveAsPNG)
		    End If
		    
		    
		    OutMask()
		    
		    f2 = GetFolderItem(f.NativePath +"/Canvas-Mask-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) +".png",3)
		    
		    
		    If f2 <> Nil Then
		      OutCanvas.Save(f2, Picture.SaveAsPNG)
		    End If
		    
		    
		    
		    //OutCanvasUpdate()
		    
		  end
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub BuildGrid(Index As integer)
		  
		  debugWindow.log("BuildGrid" + str(Index))
		  
		  
		  dim i,j,k,l,tileX,tileY,screenWidth, screenHeight,rcount,colcount,c2count,colorbarsHeight as Integer
		  dim logoRatio as Double
		  dim x,y,totX,totY,logoSize,logoHeight as Integer
		  dim textsize as Single
		  dim gridColor(), bgColor() as color
		  dim id as string
		  dim offset as Integer
		  
		  dim alphabet() as text = Array("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"_
		  ,"aa","ab","ac","ad","ae","af","ag","ah","ai","aj","ak","al","am","an","ao","ap","aq","ar","as","at","au","av","aw","ax","ay","az"_
		  ,"ba","bb","bc","bd","be","bf","bg","bh","bi","bj","bk","bl","bm","bn","bo","bp","bq","br","bs","bt","bu","bv","bw","bx","by","bz"_
		  ,"ca","cb","cc","cd","ce","cf","cg","ch","ci","cj","ck","cl","cm","cn","co","cp","cq","cr","cs","ct","cu","cv","cw","cx","cy","cz"_
		  ,"da","db","dc","dd","de","df","dg","dh","di","dj","dk","dl","dm","dn","do","dp","dq","dr","ds","dt","du","dv","dw","dx","dy","dz")
		  
		  
		  dim circlesize as integer
		  
		  Index = min(Index, GridsList.ListCount-1)
		  
		  
		  
		  if GridsList.ListCount <>0 then
		    
		    Canvas1.EraseBackground = True
		    
		    tileX = Val(GridsList.cell(Index,0))// ScaleFactor
		    tileY = Val(GridsList.cell(Index,1))'/ScaleFactor
		    screenWidth= val(GridsList.cell(Index,2))'/ScaleFactor
		    screenHeight= Val(GridsList.cell(Index,3))'/ScaleFactor
		    
		    x = 0
		    y = 0
		    k = 1
		    l = 1
		    rcount = 1
		    colcount = 1
		    c2count = 1
		    totX = (tileX*screenWidth)'/ScaleFactor
		    totY = (tileY*screenHeight)'/ScaleFactor
		    
		    MyPic = Self.BitmapForCaching(totX/ScaleFactor,totY/ScaleFactor)
		    
		    MyPic.Graphics.TextFont="Helvetica"
		    MyPic.Graphics.TextUnit=FontUnits.Pixel
		    
		    myPic.VerticalResolution = 72
		    myPic.HorizontalResolution = 72
		    
		    myPic.Graphics.ScaleX = 1
		    myPic.Graphics.ScaleY = 1
		    
		    mypic.Graphics.PenHeight = 1
		    mypic.Graphics.PenWidth = 1
		    
		    MyPic.Graphics.TextSize=max((min(tileY/5,tileX/5)),8)'font size is fifth of tileY or8pixels min
		    
		    gridColor = Array(&c000000,&cff0000,&c00ff00,&c0000ff,&cffff00,&c00ffff,&cff00ff,&cffffff)
		    
		    
		    Select Case GridsList.celltag(Index,7) 'FilledPopUp.ListIndex
		      
		    Case "100% Colour"
		      '100%
		      bgColor = Array(&cffffff,&cff00ff,&c00ffff,&cffff00,&c0000ff,&c00ff00,&cff0000,&c000000)
		    Case "50% Colour"
		      '50%
		      bgColor =   Array(&c7e7e7e,&c7e007e,&c007e7e,&c7e7e00,&c00007e,&c007e00,&c7e0000,&c000000)
		    Case "25% Colour"
		      '25%
		      bgColor = Array(&c3F3F3F,&c3F003F,&c003F3F,&c3F3F00,&c00003F,&c003F00,&c3F0000,&c000000)
		    Case "White"
		      'White
		      bgColor = Array(&c3F3F3F,&cFFFFFF,&cFFFFFF,&cFFFFFF,&cFFFFFF,&cFFFFFF,&cFFFFFF,&c000000)
		    Case "Gray"
		      'Gray
		      bgColor = Array(&c3f3f3f,&c7f7f7f,&c000000)
		    Case "Black"
		      'Black
		      bgColor = Array(&c3F3F3F,&c000000,&c000000,&c000000,&c000000,&c000000,&c000000,&c000000)
		    Case "Transparent"
		      'Blank
		      bgColor = Array(&c3F3F3F00,&c000000ff,&c000000ff,&c000000ff,&c000000ff,&c000000ff,&c000000ff,&c00000000)
		    Case "Red"
		      'Red
		      bgColor = Array(&c3F3F3F,&cdd3c46,&c000000)
		    Case "Red/Gray"
		      'Red/Gray
		      bgColor = Array(&c3F3F3F,&cdd3c46,&c3F3F3F,&c000000)
		    Case "Green"
		      'Green/Gray
		      bgColor = Array(&c3F3F3F,&c2baa3a,&c000000)
		    Case "Green/Gray"
		      'Green/Gray
		      bgColor = Array(&c3F3F3F,&c2baa3a,&c3F3F3F,&c000000)
		    Case "Blue"
		      'Blue/Gray
		      bgColor = Array(&c3F3F3F,&c0048c,&c000000)
		    Case "Blue/Gray"
		      'Blue/Gray
		      bgColor = Array(&c3F3F3F,&c0048c3,&c3F3F3F,&c000000)
		    Case "Red/Green"
		      'Red/Green
		      bgColor = Array(&c3F3F3F,&cdd3c46,&c2baa3a,&c000000)
		    Case  "Green/Blue"
		      'Green/Blue
		      bgColor = Array(&c3F3F3F,&c2baa3a,&c0048c3,&c000000)
		    Case "Blue/Red"
		      'Blue/Red
		      bgColor = Array(&c3F3F3F,&c0048c3,&cdd3c46,&c000000)
		    Case "Black/White"
		      'Black/White
		      bgColor = Array(&c3F3F3F,&c000000,&cFFFFFF,&c000000)
		    Case "Light Gray/Dark Gray"
		      'LightGray/DarkGray
		      bgColor = Array(&c3F3F3F,&c3F3F3F,&c7E7E7E,&c000000)
		    Case "Yellow"
		      'Yellow
		      bgColor = Array(&c3F3F3F,&cf4d51a,&c000000)
		    Case "Yellow/Gray"
		      'Yellow/Gray
		      bgColor = Array(&c3F3F3F,&cf4d51a,&c3f3f3f,&c000000)
		    Case "Orange"
		      'Orange/Gray
		      bgColor = Array(&c3F3F3F,&cff5722,&c000000)
		    Case "Orange/Gray"
		      'Orange
		      bgColor = Array(&c3F3F3F,&cff5722,&c3f3f3f,&c000000)
		    Case "Aqua"
		      'Aqua
		      bgColor = Array(&c3F3F3F,&c0ea7b5,&c000000)
		    Case "Aqua/Gray"
		      'Aqua/Gray
		      bgColor = Array(&c3F3F3F,&c0ea7b5,&c3f3f3f,&c000000)
		    Case "Purple"
		      'Purple
		      bgColor = Array(&c3F3F3F,&c9c6fda,&c000000)
		    Case "Purple/Gray"
		      'Purple/Gray
		      bgColor = Array(&c3F3F3F,&c9c6fda,&c3f3f3f,&c000000)
		    Case "Cyan"
		      'Cyan
		      bgColor = Array(&c3F3F3F,&c00CBCB00,&c000000)
		    Case "Magenta"
		      'Magenta
		      bgColor = Array(&c3F3F3F,&cB200B200,&c000000)
		    Case "Rainbow"
		      'Rainbow &c4b008200,
		      bgColor = Array(&c3F3F3F00,&c9400d300,&c0000ff00,&c00ff0000,&cffff0000,&cff7f0000,&cff000000,&c00000000)
		    Case "Veg"
		      bgColor = Array(&cb80a46,&c5e362c,&c622d4b,&c4f5514,&cc96f1c,&cbbc467)
		    Case "Camouflauge"
		      bgColor = Array(&c50523c,&cd6cab4,&cdbbe95,&c394730,&c3e3d,&c394730,&c382225,&c802021)
		    Case "Alt Red"
		      'ALT Red
		      bgColor = Array(&c3F3F3F00,&cFF000000,&cCC000000,&c00000000)
		    Case "Alt Green"
		      'Alt Green
		      bgColor = Array(&c3F3F3F00,&c00FF0000,&c00CC0000,&c00000000)
		    Case "Alt Blue"
		      'Alt Blue
		      bgColor = Array(&c3F3F3F00,&c0000FF00,&c0000CC00,&c00000000)
		    Case "Grayscale V" , "Grayscale H"
		      'Grayscale
		      bgColor=Array(&c3F3F3F00,&c00000000,&c33333300,&c66666600,&c99999900,&cCCCCCC00,&cFFFFFF00,&c00000000)
		    Case "Fruit"
		      'Apple Logo
		      bgColor = Array(&c3F3F3F00,&c118AD400,&c82258500 ,&cD6222E00,&cF16C1A00 ,&cF8AA1F00,&c52B13700 ,&c00000000)
		    Case "Full Red"
		      'Red
		      bgColor = Array(&c3F3F3F,&cFF000000,&c000000)
		    Case "Full Green"
		      'Green
		      bgColor = Array(&c3F3F3F,&c00FF0000,&c000000)
		    Case "Full Blue"
		      'Blue
		      bgColor = Array(&c3F3F3F,&c0000FF00,&c000000)
		    Case "Reduced/Full Check"
		      'Blue
		      bgColor = Array(&c3F3F3F,&c000000,&c101010,&cebebeb,&cffffff,&c000000)
		      
		    Else
		      bgColor = Array(&c3F3F3F,&c3F003F,&c003F3F,&c3F3F00,&c00003F,&c003F00,&c3F0000,&c000000)
		    End Select
		    
		    
		    
		    for j = 1  to screenHeight //draw row
		      
		      for i = 1 to screenWidth //draw column
		        if val(GridsList.cell(Index,7)) = 5 then
		          'Blank BG
		          
		        elseif val(GridsList.cell(Index,7)) = 3 then
		          'White BG
		          MyPic.Graphics.ForeColor  = &cffffff
		          MyPic.Graphics.FillRect(x,y,tileX,tileY)
		        elseif val(GridsList.cell(Index,7)) = 4 then
		          'Black BG
		          MyPic.Graphics.ForeColor  = &c000000
		          MyPic.Graphics.FillRect(x,y,tileX,tileY)
		          
		        else
		          MyPic.Graphics.ForeColor  = (bgColor(k))
		          MyPic.Graphics.FillRect(x,y,tileX,tileY)
		        end
		        
		        'Draw grid lines. Colour or Black or White
		        if GridsList.cellcheck(Index,8) then
		          if GridColour.Value then
		            MyPic.Graphics.ForeColor  = (gridColor(l))
		          else
		            if GridsList.celltag(Index,7) <> "White" then 
		              
		              MyPic.Graphics.ForeColor  = &cffffff00
		            else
		              MyPic.Graphics.ForeColor  = &c00000000
		            end
		          end
		          MyPic.Graphics.DrawRect(x, y, tileX,tileY)
		        end
		        
		        'if FilledPopUp.ListIndex = 3 then
		        if (bgColor(k))=&cFFFFFF00 then
		          MyPic.Graphics.ForeColor  = &c656565 '(gridColor(0))
		        else
		          MyPic.Graphics.ForeColor  = (gridColor(7))
		        end
		        
		        if GridsList.cellcheck(Index,10) then
		          if col_alpha.ListIndex = 1 then
		            dim alpha as integer =  ((i-1) mod (Ubound(alphabet)+1))
		            id = (Uppercase(alphabet(alpha)) + "," +str(j))                                      //row, column numbering
		          elseif col_alpha.ListIndex = 2 then
		            dim alpha as integer =  ((j-1) mod (Ubound(alphabet)+1))
		            id = (str(i) + "," +Uppercase(alphabet(alpha)))                                      //row, column numbering
		          else
		            id = (str(j) + "," +str(i))                                      //row, column numbering
		          end
		          
		          'MyPic.Graphics.DrawString(id, (x+1),(y+max((tileY/5),8)))           //tile address
		          MyPic.Graphics.DrawString(id, (x+1),(y+MyPic.Graphics.StringHeight(id,tileX)))  
		        end
		        
		        x = x + tileX
		        l=l+1
		        if l > Ubound(gridColor)-1 then
		          l=1
		        end
		        if GridsList.celltag(Index,7) <> "Grayscale H" then 'check for grayscale H and dont increment
		          rcount = rcount +1
		        end
		        if rcount  > Ubound(bgColor)-1 then
		          rcount = 1
		        end
		        k = rcount     'colour is row count
		      next
		      
		      if GridsList.celltag(Index,7) <> "Grayscale V" then 'check for grayscale V and dont increment
		        c2count = c2count + 1
		        colcount = colcount + 1
		      end
		      
		      if c2count > Ubound(gridcolor) -1 then
		        c2count = 1
		      end
		      l = c2count
		      
		      if colcount > Ubound(bgColor)-1 then
		        colcount = 1
		      end
		      rcount = colcount
		      k = colcount
		      
		      x = 0
		      y = y + tileY
		      
		    next
		    
		    'draw diagonal cross
		    if GridsList.cellcheck(Index,12) then
		      myPic.Graphics.ForeColor = &c00ffff
		      MyPic.graphics.DrawLine ( 0,0,totX,totY)
		      MyPic.graphics.DrawLine ( 0,totY,totX,0)
		    end
		    
		    'Draw colorbars
		    if GridsList.cellcheck(Index,15)  then
		      if totY > totX then 
		        myPic.Graphics.DrawPicture(colorbars, 10,((totY/2)-(totY/10))   ,(totX-20),(totY/5)    ,0,0,1920,330)
		        'colorbarsHeight = (totY/5)-((totY/2)-(totY/10))
		        colorbarsHeight = (totY/5)
		      else
		        myPic.Graphics.DrawPicture(colorbars,  ((totX/2)-(totY/2)+10),((totY/2)-(totY/10))   ,(totY-20),(totY/5),0,0,1920,330)
		        'colorbarsHeight = (totY/5)-((totY/2)-(totY/10))
		        colorbarsHeight = (totY/5)
		      end
		    end
		    
		    
		    
		    'Draw Circle
		    if GridsList.cellcheck(Index,11) then 
		      
		      circlesize =min((totY),(totX))
		      
		      if val(GridsList.cell(Index,8))= 3 then
		        MyPic.Graphics.ForeColor  = &c000000
		      else
		        MyPic.Graphics.ForeColor  = &cffffff
		      end
		      MyPic.Graphics.DrawOval((totX/2)-(circlesize/2),(totY/2)-(circlesize/2),circlesize,circlesize)
		    end
		    
		    
		    
		    
		    if GridsList.cellcheck(Index,13) then 
		      'Draw Corner circles
		      'TL-Red
		      circlesize = min((myPic.Height/2)-5,(totX/2)-5,tileX*2)
		      
		      myPic.graphics.ForeColor = &cff0000
		      MyPic.Graphics.DrawOval(0,0,circlesize,circlesize)
		      'TR-Green
		      myPic.graphics.ForeColor = &c00ff00
		      MyPic.Graphics.DrawOval((totX-circlesize),0,circlesize,circlesize)
		      'BL-Blue
		      myPic.graphics.ForeColor = &c0000ff
		      MyPic.Graphics.DrawOval(0,(totY-circlesize),circlesize,circlesize)
		      'BR-Yellow
		      myPic.graphics.ForeColor = &cffff00
		      MyPic.Graphics.DrawOval((totX-circlesize),(totY-circlesize),circlesize,circlesize)
		      myPic.graphics.ForeColor = &cffffff
		    end
		    
		    if GridsList.cellcheck(Index,9) then 
		      'Draw canvas Raster
		      
		      
		      
		      if val(GridsList.cell(Index,7)) = 3 then
		        MyPic.Graphics.ForeColor  = &c000000
		      else
		        MyPic.Graphics.ForeColor  = &cffffff
		      end
		      MyPic.Graphics.DrawRect(0,0,totX,totY)
		    end
		    
		    'Draw logo
		    
		    
		    if totX > totY then
		      logoSize= min(totX,icon.width)
		      logoHeight=(icon.height/icon.width)*logoSize
		      while logoHeight > (totY-5) or logoSize > totX/4
		        logoSize = logoSize -1
		        logoHeight=(icon.height/icon.width)*logoSize
		      wend
		    else
		      logoSize= min(totX,icon.width)
		      logoHeight=(icon.height/icon.width)*logoSize
		      while logoHeight > (totY-5) or logoSize > totX/1.5
		        logoSize = logoSize -1
		        logoHeight=(icon.height/icon.width)*logoSize
		      wend
		    end
		    
		    
		    
		    
		    if GridsList.cellcheck(Index,14) then 
		      myPic.Graphics.Transparency = app.logoOpacity
		      'myPic.Graphics.DrawPicture(icon,(totX-(logoSize)-(tileX*2)),(totY-(logoSize)-3),(logoSize),(logoSize),0,0,icon.width,icon.height)
		      myPic.Graphics.DrawPicture(icon,(totX-(logoSize+3)),(totY-(logoHeight)-3),(logoSize),(logoHeight),0,0,icon.width,icon.height)
		    end
		    
		    
		    'custom text
		    myPic.Graphics.Transparency = 0
		    offset = 5
		    if (GridsList.cell(Index,6)) <> ""  then 
		      circlesize =min((totY),(totX))
		      MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		      
		      if alt_text.value then
		        id = (GridsList.cell(Index,6))
		        
		        textsize = 250                            'initial text size before resize 
		        MyPic.Graphics.TextSize=textsize
		        MyPic.Graphics.Bold = True
		        while (MyPic.Graphics.StringWidth(id) > max((totX/2),circlesize)) or (MyPic.Graphics.StringHeight(id,circlesize) > totY)
		          if textsize <1 then
		            exit
		          else
		            textsize = textsize -5
		          end
		          MyPic.Graphics.TextSize=textsize
		        wend
		        'msgbox(str(textsize))
		        If colorbarsHeight = 0 then
		          
		          if dropShadow.value then
		            'add drop shadow to large central text
		            MyPic.Graphics.ForeColor  = &c0000007f
		            MyPic.Graphics.DrawString(id,(totX/2-(myPic.Graphics.StringWidth(id)/2)+offset),(totY/2)+(MyPic.Graphics.StringHeight(id,totX)/3)+offset)
		          end
		          MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		          MyPic.Graphics.DrawString(id,(totX/2-(myPic.Graphics.StringWidth(id)/2)),(totY/2)+(MyPic.Graphics.StringHeight(id,totX)/3))
		        else
		          
		          if dropShadow.value then
		            'add drop shadow
		            MyPic.Graphics.ForeColor  = &c0000007f
		            MyPic.Graphics.DrawString(id,(totX/2-(myPic.Graphics.StringWidth(id)/2)+offset),(totY/2)-(colorbarsHeight/2)-3+offset)
		          end
		          MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		          MyPic.Graphics.DrawString(id,(totX/2-(myPic.Graphics.StringWidth(id)/2)),(totY/2)-(colorbarsHeight/2)-3)
		        end
		        id = (str(totX) + "x" + str(totY))
		        MyPic.Graphics.TextSize=max(min((totX/10),26),12)'font size is third of tileY or 12pixels min
		        
		        offset = 1
		        if dropShadow.value then
		          'add drop shadow
		          MyPic.Graphics.ForeColor  = &c0000007f
		          MyPic.Graphics.DrawString(id,3+offset,(totY-3+offset))
		        end
		        MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		        
		        //debug.log("TextSize(Big)" + ","+str(MyPic.Graphics.TextSize))
		        MyPic.Graphics.Bold = False
		        MyPic.Graphics.DrawString(id,3,(totY-3))
		      else
		        id = (GridsList.cell(Index,6) + "     " +  str(totX) + "x" + str(totY))
		        MyPic.Graphics.TextSize=max(min((totX/12),26),10)'font size is third of tileY or 10pixels min
		        
		        // debug.log("TextSize(small)" + ","+str(MyPic.Graphics.TextSize))
		        if (myPic.Graphics.StringWidth(id)) < totX then
		          
		          offset = 1
		          if dropShadow.value then
		            'add drop shadow
		            MyPic.Graphics.ForeColor  = &c0000007f
		            MyPic.Graphics.DrawString(id,5+offset,(totY-5+offset))
		          end
		          MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		          
		          MyPic.Graphics.DrawString(id,5,(totY-5))
		        else
		          id = (GridsList.cell(Index,6))
		          MyPic.Graphics.DrawString(id,(totX/2-(myPic.Graphics.StringWidth(id)/2)),(totY/2))
		          id = (str(totX) + "x" + str(totY))
		          
		          offset = 1
		          if dropShadow.value then
		            'add drop shadow
		            MyPic.Graphics.ForeColor  = &c0000007f
		            MyPic.Graphics.DrawString(id,3+offset,(totY-5+offset))
		          end
		          MyPic.Graphics.ForeColor  = ColorPicker.FillColor
		          
		          MyPic.Graphics.DrawString(id,3,(totY-5))
		        end
		        
		      end
		      
		      
		    end
		    
		    
		  else
		    myPic.Graphics.ClearRect(0,0,1,1)
		  end
		  
		  
		  rebuild=false
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub DeleteList()
		  
		  
		  if GridsList.SelCount = GridsList.ListCount then 
		    MsgBox("Must have one grid")
		    
		  elseif GridsList.SelCount > 1 then
		    
		    for i as integer=GridsList.listcount-1 downto 0
		      if GridsList.selected(i) then
		        
		        GridsList.removeRow(i)
		        
		        
		      end if
		    next
		    
		    
		  else
		    
		    
		    if GridsList.listcount >1 Then
		      
		      if GridsList.ListIndex <> -1 then
		        if GridsList.ListIndex = 0 then
		          GridsList.removeRow(GridsList.ListIndex)
		        else
		          GridsList.Selected(GridsList.ListIndex-1) = True
		          GridsList.removeRow(GridsList.ListIndex+1)
		        end
		        
		      else
		        MsgBox("Please select grid to Delete")
		      end
		      
		    else
		      MsgBox("Must have one grid")
		    end
		    
		  end
		  
		  UpdateScreen()
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub FitH()
		  If Not GorC  Then
		    
		    if canvas1.width <> scaledwidth then
		      
		      mscale = (canvas1.width/MyPic.width)*100
		      Window1.Canvas1.Refresh
		      
		    end
		    
		  else
		    if canvas1.width <> scaledwidth then
		      
		      mscale = (canvas1.width/OutCanvas.width)*100
		      Window1.Canvas1.Refresh
		      
		    end
		    
		  end
		  zoom.Text=str(round(mScale))+"%"
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub FitV()
		  If Not GorC Then
		    
		    if canvas1.height <> scaledheight then
		      
		      mscale = (canvas1.height/MyPic.height)*100
		      Window1.Canvas1.Refresh
		      
		    end
		    
		  else
		    if canvas1.height <> scaledheight then
		      
		      mscale = (canvas1.height/OutCanvas.height)*100
		      Window1.Canvas1.Refresh
		      
		    end
		    
		  end
		  zoom.Text=str(round(mScale))+"%"
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub LoadFile(f As FolderItem = Nil)
		  debugWindow.Log("Load File")
		  
		  Dim file As FolderItem = f
		  Dim tis As TextInputStream
		  Dim s As String
		  Dim i, j As Integer
		  Dim fields() As String
		  Dim old_ver As Boolean = False
		  
		  If file Is Nil Then
		    'show standard file selector
		    file = GetOpenFolderItem(GridFileType.pg2)
		    if file=nil then exit sub             'cancel clicked
		  end if
		  
		  If file <> Nil Then
		    'open the file
		    tis = TextInputStream.Open(file)
		    if tis=nil then                        'failed?
		      MsgBox("The file could not be opened.")
		      exit sub
		    end if
		    
		    'read file into grid
		    if not tis.EOF then
		      GridsList.DeleteAllRows
		      
		      s=tis.ReadLine                    'read line from file
		      fields=Split(s,",")                 'put items in fileds() array
		      'imports grid size and options
		      
		      if fields.Ubound < 10 then old_ver = true
		      For j  = 0 to fields.Ubound
		        Select Case j
		        Case 0
		          Window1.OutH.text = Trim(fields(0))
		        Case 1
		          Window1.OutV.text = Trim(fields(1))
		        Case 2
		          if Trim(fields(2)) = "True" then
		            Window1.stats.value = True
		          else
		            Window1.stats.value = False
		          end
		        Case 3
		          if Trim(fields(3)) = "True" then
		            Window1.originCursor.value = True
		          else
		            Window1.originCursor.value = False
		          end
		        Case 4
		          if Trim(fields(4)) = "True" then
		            Window1.alt_text.value = True
		          else
		            Window1.alt_text.value = False
		          end
		        Case 5
		          dim v as variant
		          v=val(Trim(fields(5)))
		          ColorPicker.FillColor=v.colorvalue
		        Case 6
		          if Trim(fields(6)) = "True" then
		            GridColour.value = True
		          else
		            GridColour.value = False
		          end
		        Case 7
		          CanvasText.text = Trim(fields(7))
		        Case 8
		          TP = val(Trim(fields(8)))
		          TextPos.ListIndex = val(Trim(fields(8)))
		        Case 9
		          col_alpha.ListIndex = val(Trim(fields(9)))
		        Case 10 
		          if Trim(fields(10)) = "True" then
		            dropShadow.value = True
		          else
		            dropShadow.value = False
		          end
		          
		        else
		          MsgBox("Too many parameters, possibly corrupt.") 
		        end select
		      next
		      
		      
		      
		    end
		    while not tis.EOF                    'while not end-of-file
		      GridsList.AddRow ""             'add row to grid
		      s=tis.ReadLine                    'read line from file
		      fields=Split(s,",")                 'put items in fields() array
		      if fields.Ubound < 15 then old_ver = true
		      For j  = 0 to fields.Ubound
		        Select Case j
		        Case 0,1,2,3,4,5,6
		          GridsList.Cell(GridsList.ListCount-1,j)=Trim(fields(j))
		        Case 7
		          GridsList.celltag(GridsList.LastIndex,7)=Trim(fields(7))
		        Case 8,9,10,11,12,13,14,15
		          If Trim(fields(j)) = "True" then
		            GridsList.cellcheck(GridsList.Lastindex,j) = True 
		          else
		            GridsList.cellcheck(GridsList.Lastindex,j) = False
		          end
		        else
		          MsgBox("Too many parameters, possibly corrupt.") 
		        end select
		      next
		      
		      
		    wend
		    
		    Window1.Title="Editor - " + file.Name
		    
		    tis.Close                                 'close file
		    
		    GorC = true
		    Grid_Solo.Visible = True
		    LabelClass01.Visible=True
		    LabelClass02.Visible=True
		    MaskMode.Visible = true
		    stats.Visible = true
		    statsText.Visible = true
		    originCursor.Visible = true
		    originText.Visible = true
		    T_Canvas.Visible = true
		    T_CanvasText.Visible = true
		    TextPos.Visible = true
		    // T_Canvas.value = Preferences.Tcanvas
		    
		    
		    GridCanvas_select.Items(1).selected = True
		    
		    
		    UpdateScreen()
		    
		    fitH()
		    
		    if old_ver = true then MsgBox("Possibly saved from an old version, please check and re-save")
		    
		  end if
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub LoadFileXml(f As FolderItem = Nil)
		  Dim file As FolderItem = f
		  
		  If file is Nil Then 
		    file = GetOpenFolderItem(GridFileType.pg3)
		    if file is nil then exit sub             'cancel clicked
		  end
		  
		  Dim xml As New XMLDocument
		  
		  
		  If file <> Nil Then
		    Try
		      xml.LoadXML(file)
		    Catch e As XMLException
		      MsgBox("XML Error.")
		      Return
		    End Try
		    
		  end if
		  
		  Dim root As XmlNode
		  Dim canvas, grid As XmlNode
		  
		  root = xml.FirstChild
		  
		  If root.Name = "gridList" Then
		    
		    GridsList.DeleteAllRows
		    
		    canvas = root.FirstChild
		    
		    While canvas <> Nil
		      //msgBox(canvas.GetAttribute("canvasName"))
		      
		      CanvasText.Text =canvas.GetAttribute("canvasName")
		      Window1.OutH.Text = canvas.GetAttribute("outH")
		      Window1.OutV.Text = canvas.GetAttribute("outV")
		      Window1.stats.Value = if (canvas.GetAttribute("raster") = "true", True, False)
		      Window1.originCursor.Value = if (canvas.GetAttribute("originCursor") = "true", True, False)
		      Window1.T_Canvas.Value = if (canvas.GetAttribute("transparentCanvas") = "true", True, False)
		      Window1.alt_text.Value = if (canvas.GetAttribute("largeText") = "true", True, False)
		      
		      dim v as variant = val(canvas.GetAttribute("textColour"))
		      ColorPicker.FillColor=v.colorvalue
		      
		      GridColour.Value = if (canvas.GetAttribute("colourGrid") = "true", True, False)
		      
		      TP = val(canvas.GetAttribute("textPosition"))
		      TextPos.ListIndex = val(canvas.GetAttribute("textPosition"))
		      
		      col_alpha.ListIndex = val(canvas.GetAttribute("colDtype"))
		      
		      dropShadow.Value = if (canvas.GetAttribute("dropShadow") = "true", True, False)
		      
		      
		      grid = canvas.FirstChild
		      For i As Integer = 0 To canvas.ChildCount - 1
		        grid = canvas.Child(i)
		        //msgBox(grid.GetAttribute("gridName")+" . " + grid.GetAttribute("background"))
		        
		        GridsList.AddRow ""             'add row to grid
		        GridsList.Cell(GridsList.ListCount-1,0) = grid.GetAttribute("tileX")
		        GridsList.Cell(GridsList.ListCount-1,1) = grid.GetAttribute("tileY")
		        GridsList.Cell(GridsList.ListCount-1,2) = grid.GetAttribute("cols")
		        GridsList.Cell(GridsList.ListCount-1,3) = grid.GetAttribute("rows")
		        GridsList.Cell(GridsList.ListCount-1,4) = grid.GetAttribute("offX")
		        GridsList.Cell(GridsList.ListCount-1,5) = grid.GetAttribute("offY")
		        GridsList.Cell(GridsList.ListCount-1,6) = grid.GetAttribute("gridName")
		        
		        GridsList.celltag(GridsList.ListCount-1,7)=grid.GetAttribute("background")
		        
		        GridsList.cellcheck(GridsList.ListCount-1,8)= if (grid.GetAttribute("grid") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,9)= if (grid.GetAttribute("raster") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,10)= if (grid.GetAttribute("tileID") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,11)= if (grid.GetAttribute("circle") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,12)= if (grid.GetAttribute("cross") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,13)= if (grid.GetAttribute("corner") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,14)= if (grid.GetAttribute("logo") = "true", True, False)
		        GridsList.cellcheck(GridsList.ListCount-1,15)= if (grid.GetAttribute("colorBars") = "true", True, False)
		        
		      Next
		      canvas = canvas.NextSibling //multiple canvasses?
		    Wend
		    
		    Window1.Title="Editor - " + file.Name
		    
		    app.newChanges = false
		    
		    GorC = true
		    Grid_Solo.Visible = True
		    LabelClass01.Visible=True
		    LabelClass02.Visible=True
		    MaskMode.Visible = true
		    stats.Visible = true
		    statsText.Visible = true
		    originCursor.Visible = true
		    originText.Visible = true
		    T_Canvas.Visible = true
		    T_CanvasText.Visible = true
		    TextPos.Visible = true
		    // T_Canvas.value = Preferences.Tcanvas
		    
		    
		    GridCanvas_select.Items(1).selected = True
		    
		    
		    UpdateScreen()
		    
		    fitH()
		    
		  Else
		    MsgBox("Not a gridList XML file.")
		  End If
		  
		  
		  
		  
		  'For i As Integer = 0 To root.ChildCount - 1
		  '
		  '// Add Canvas
		  'canvas = root.Child(i)
		  'msgBox(canvas.GetAttribute("canvasName"))
		  '
		  '// Add Grids
		  'For j As Integer = 0 To canvas.ChildCount - 1
		  'grid = canvas.Child(j)
		  'msgBox(grid.GetAttribute("gridName") + grid.GetAttribute("background"))
		  'Next
		  '
		  'Next
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub OnetoOne()
		  mScale=100
		  Window1.Canvas1.Refresh
		  zoom.Text=str(mScale)+"%"
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub OutCanvasUpdate()
		  
		  
		  debugWindow.log("OutCanvasUpdate")
		  
		  'Dim d As SaveAsDialog
		  'd = New SaveAsDialog
		  Dim id as String
		  dim i  as Integer
		  
		  OutCanvas= Self.BitmapForCaching(val(OutH.Text)/ScaleFactor, val(OutV.Text)/ScaleFactor)
		  
		  OutCanvas.VerticalResolution = 72
		  OutCanvas.HorizontalResolution = 72
		  
		  OutCanvas.Graphics.ScaleX = 1
		  OutCanvas.Graphics.ScaleY = 1
		  
		  
		  OutCanvas.Graphics.PenHeight = 1
		  OutCanvas.Graphics.PenWidth = 1
		  
		  
		  
		  OutCanvas.Graphics.ForeColor = RGB(0, 0, 0)
		  
		  if Not T_canvas.value or  MaskMode.value then 
		    OutCanvas.Graphics.FillRect(0,0,val(OutH.Text), val(OutV.Text))
		  end if
		  
		  if GridsList.ListIndex = -1 or Grid_Solo.value= false then
		    
		    for i = 0 to GridsList.Listcount-1
		      if MaskMode.value then
		        
		        dim gridwidth as integer = val(GridsList.cell(i,0))*val(GridsList.Cell(i,2))
		        dim gridheight as Integer = val(GridsList.cell(i,1))*val(GridsList.Cell(i,3))
		        OutCanvas.Graphics.ForeColor = RGB(0, 0, 0, 0)
		        
		        OutCanvas.graphics.ClearRect(val(GridsList.cell(i,4)), val(GridsList.cell(i,5)),gridwidth, gridheight)
		        'msgbox ("blank" + GridsList.cell(i,4) + GridsList.cell(i,5))
		        
		        
		      else
		        BuildGrid(i)
		        OutCanvas.Graphics.DrawPicture(myPic,val(GridsList.Cell(i,4)),val(GridsList.Cell(i,5)))
		      end
		      
		      Dim offX as double = val(GridsList.Cell(i,4))
		      Dim offY as double = val(GridsList.Cell(i,5))
		      
		      if Window1.originCursor.Value and not MaskMode.value then
		        'Display offset markers
		        OutCanvas.graphics.ForeColor = RGB(255,255,255)
		        OutCanvas.Graphics.DrawLine(offX, 0, OffX,OffY)
		        OutCanvas.Graphics.DrawLine((offX-5),(OffY-5),OffX,OffY)
		        OutCanvas.Graphics.DrawLine((offX-5),(OffY+5),OffX,OffY)
		        OutCanvas.Graphics.DrawLine((offX+5),(OffY-5),OffX,OffY)
		        
		        OutCanvas.Graphics.DrawLine(0, offY, OffX,OffY)
		        
		        'Display offset numbers
		        'OutCanvas.Graphics.TextSize=15
		        OutCanvas.Graphics.TextSize=min((val(GridsList.Cell(i,1))/5),15)
		        id = "TL:"+ GridsList.Cell(i,4) + "," + GridsList.Cell(i,5)
		        dim a as Integer = OutCanvas.Graphics.StringHeight(id,val(GridsList.Cell(i,0))*2)
		        OutCanvas.Graphics.DrawString(id,offX+5,offY+(a*2))
		      end
		      
		      
		    next
		  else
		    i = GridsList.ListIndex
		    
		    if MaskMode.value then
		      
		      dim gridwidth as integer = val(GridsList.cell(i,0))*val(GridsList.Cell(i,2))
		      dim gridheight as Integer = val(GridsList.cell(i,1))*val(GridsList.Cell(i,3))
		      OutCanvas.Graphics.ForeColor = RGB(0, 0, 0, 0)
		      
		      OutCanvas.graphics.ClearRect(val(GridsList.cell(i,4)), val(GridsList.cell(i,5)),gridwidth, gridheight)
		      'msgbox ("blank" + GridsList.cell(i,4) + GridsList.cell(i,5))
		      
		      
		    else
		      BuildGrid(i)
		      OutCanvas.Graphics.DrawPicture(myPic,val(GridsList.Cell(i,4)),val(GridsList.Cell(i,5)))
		    end
		    
		    
		    
		    Dim offX as double = val(GridsList.Cell(i,4))
		    Dim offY as double = val(GridsList.Cell(i,5))
		    
		    if Window1.originCursor.Value and not MaskMode.value then
		      'Display offset markers
		      OutCanvas.graphics.ForeColor = RGB(255,255,255)
		      OutCanvas.Graphics.DrawLine(offX, 0, OffX,OffY)
		      OutCanvas.Graphics.DrawLine((offX-5),(OffY-5),OffX,OffY)
		      OutCanvas.Graphics.DrawLine((offX-5),(OffY+5),OffX,OffY)
		      OutCanvas.Graphics.DrawLine((offX+5),(OffY-5),OffX,OffY)
		      OutCanvas.Graphics.DrawLine(0, offY, OffX,OffY)
		      
		      'Display offset numbers
		      OutCanvas.Graphics.TextSize=min((val(GridsList.Cell(i,1))/5),15)
		      id = "TL:"+ GridsList.Cell(i,4) + "," + GridsList.Cell(i,5)
		      dim a as Integer = OutCanvas.Graphics.StringHeight(id,val(GridsList.Cell(i,0))*2)
		      OutCanvas.Graphics.DrawString(id,offX+5,offY+(a*2))
		    end
		    
		    
		    
		  end
		  
		  
		  'Display canvas raster
		  if Window1.stats.Value and not MaskMode.value then
		    OutCanvas.Graphics.ForeColor  = &cffffff
		    OutCanvas.Graphics.DrawRect(0,0,val(OutH.Text), val(OutV.Text))
		  end
		  
		  
		  
		  if CanvasText.text <> "" and not MaskMode.value then
		    OutCanvas.Graphics.ForeColor  = &cffffff
		    OutCanvas.Graphics.TextSize=25
		    id = "Canvas  :"+OutH.text+"px x "+OutV.text+"px"+ chr(13) + CanvasText.Text
		    dim w as integer = OutCanvas.Graphics.Stringwidth(id)
		    dim h as Integer = OutCanvas.Graphics.StringHeight(id,w)
		    
		    Select Case TP
		    Case 0 'TL
		      TextXpos = 0
		      TextYpos = 0
		    Case 1 'TC
		      TextXpos = (OutCanvas.Width/2)-(w/2)-3
		      TextYpos = 0
		    Case 2 'TR
		      TextXpos = OutCanvas.Width-w-5
		      TextYpos = 0
		    Case 3 'BL
		      TextXpos = 0
		      TextYpos = OutCanvas.Height-h-5
		    Case 4 'BC
		      TextXpos = (OutCanvas.Width/2)-(w/2)-3
		      TextYpos = OutCanvas.Height-h-5
		    Case 5 'BR
		      TextXpos = OutCanvas.Width-w-5
		      TextYpos = OutCanvas.Height-h-5
		      
		    end select
		    
		    OutCanvas.Graphics.DrawString(id,TextXpos+5,TextYpos+25)
		    OutCanvas.Graphics.DrawRect(TextXpos,TextYpos,w+5,h+5)
		  end
		  
		  
		  
		  
		  BuildGrid(picindex) 'ensure last build grid is currently selected one from list.
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub OutCursor()
		  'debug.log("OutCursorUpdate")
		  
		  'Dim d As SaveAsDialog
		  'd = New SaveAsDialog
		  Dim id as String
		  dim i  as Integer
		  
		  OutCanvas= Self.BitmapForCaching(val(OutH.Text)/ScaleFactor, val(OutV.Text)/ScaleFactor)
		  
		  OutCanvas.VerticalResolution = 72
		  OutCanvas.HorizontalResolution = 72
		  
		  OutCanvas.Graphics.ScaleX = 1
		  OutCanvas.Graphics.ScaleY = 1
		  
		  
		  OutCanvas.Graphics.PenHeight = 1
		  OutCanvas.Graphics.PenWidth = 1
		  
		  OutCanvas.Graphics.ForeColor = RGB(0, 0, 0)
		  
		  for i = 0 to GridsList.Listcount-1
		    
		    
		    dim gridwidth as integer = val(GridsList.cell(i,0))*val(GridsList.Cell(i,2))
		    dim gridheight as Integer = val(GridsList.cell(i,1))*val(GridsList.Cell(i,3))
		    OutCanvas.Graphics.ForeColor = RGB(0, 0, 0, 0)
		    
		    OutCanvas.graphics.ClearRect(val(GridsList.cell(i,4)), val(GridsList.cell(i,5)),gridwidth, gridheight)
		    
		    
		    Dim offX as double = val(GridsList.Cell(i,4))
		    Dim offY as double = val(GridsList.Cell(i,5))
		    
		    
		    'Display offset markers
		    OutCanvas.graphics.ForeColor = RGB(255,255,255)
		    OutCanvas.Graphics.DrawLine(offX, 0, OffX,OffY)
		    OutCanvas.Graphics.DrawLine((offX-5),(OffY-5),OffX,OffY)
		    OutCanvas.Graphics.DrawLine((offX-5),(OffY+5),OffX,OffY)
		    OutCanvas.Graphics.DrawLine((offX+5),(OffY-5),OffX,OffY)
		    
		    OutCanvas.Graphics.DrawLine(0, offY, OffX,OffY)
		    
		    'Display offset numbers
		    'OutCanvas.Graphics.TextSize=15
		    OutCanvas.Graphics.TextSize=min((val(GridsList.Cell(i,1))/5),15)
		    id = "TL:"+ GridsList.Cell(i,4) + "," + GridsList.Cell(i,5)
		    dim a as Integer = OutCanvas.Graphics.StringHeight(id,val(GridsList.Cell(i,0))*2)
		    OutCanvas.Graphics.DrawString(id,offX+5,offY+(a*2))
		    
		    
		    
		  next
		  
		  
		  'Display canvas raster
		  
		  OutCanvas.Graphics.ForeColor  = &cffffff
		  OutCanvas.Graphics.DrawRect(0,0,val(OutH.Text), val(OutV.Text))
		  
		  
		  
		  
		  
		  OutCanvas.Graphics.ForeColor  = &cffffff
		  OutCanvas.Graphics.TextSize=25
		  id = "Canvas  :"+OutH.text+"px x "+OutV.text+"px"+ chr(13) + CanvasText.Text
		  dim w as integer = OutCanvas.Graphics.Stringwidth(id)
		  dim h as Integer = OutCanvas.Graphics.StringHeight(id,w)
		  
		  Select Case TP
		  Case 0 'TL
		    TextXpos = 0
		    TextYpos = 0
		  Case 1 'TC
		    TextXpos = (OutCanvas.Width/2)-(w/2)-3
		    TextYpos = 0
		  Case 2 'TR
		    TextXpos = OutCanvas.Width-w-5
		    TextYpos = 0
		  Case 3 'BL
		    TextXpos = 0
		    TextYpos = OutCanvas.Height-h-5
		  Case 4 'BC
		    TextXpos = (OutCanvas.Width/2)-(w/2)-3
		    TextYpos = OutCanvas.Height-h-5
		  Case 5 'BR
		    TextXpos = OutCanvas.Width-w-5
		    TextYpos = OutCanvas.Height-h-5
		    
		  end select
		  
		  OutCanvas.Graphics.DrawString(id,TextXpos+5,TextYpos+25)
		  OutCanvas.Graphics.DrawRect(TextXpos,TextYpos,w+5,h+5)
		  
		  
		  BuildGrid(picindex) 'ensure last build grid is currently selected one from list.
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub OutMask()
		  'debug.log("OutMask")
		  
		  
		  Dim id as String
		  dim i  as Integer
		  
		  OutCanvas= Self.BitmapForCaching(val(OutH.Text)/ScaleFactor, val(OutV.Text)/ScaleFactor)
		  
		  OutCanvas.VerticalResolution = 72
		  OutCanvas.HorizontalResolution = 72
		  
		  OutCanvas.Graphics.ScaleX = 1
		  OutCanvas.Graphics.ScaleY = 1
		  
		  
		  OutCanvas.Graphics.PenHeight = 1
		  OutCanvas.Graphics.PenWidth = 1
		  
		  
		  OutCanvas.Graphics.ForeColor = RGB(0, 0, 0)
		  OutCanvas.Graphics.FillRect(0,0,val(OutH.Text), val(OutV.Text))
		  
		  for i = 0 to GridsList.Listcount-1
		    
		    dim gridwidth as integer = val(GridsList.cell(i,0))*val(GridsList.Cell(i,2))
		    dim gridheight as Integer = val(GridsList.cell(i,1))*val(GridsList.Cell(i,3))
		    OutCanvas.Graphics.ForeColor = RGB(0, 0, 0, 0)
		    
		    OutCanvas.graphics.ClearRect(val(GridsList.cell(i,4)), val(GridsList.cell(i,5)),gridwidth, gridheight)
		    
		  next
		  
		  BuildGrid(picindex) 'ensure last build grid is currently selected one from list.
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub ResolumeExport()
		  Dim f, f2 As folderitem
		  Dim tos As textOutputStream
		  Dim s As String
		  Dim i, j As Integer
		  
		  
		  'show standard file selector
		  f= GetSaveFolderItem(ExtendScript.xml,"Resolume Export - "+CanvasText.Text+".xml")
		  If f = Nil Then Exit Sub                              'cancel clicked
		  
		  'create file
		  tos = f.CreateTextFile
		  If tos = Nil Then                                       'failed?
		    MsgBox("The file could not be created!")
		    Exit Sub
		  End If
		  
		  s = RE1
		  
		  tos.WriteLine s                'save line
		  
		  
		  If GridsList.ListCount>0 Then                   'if grid not empty
		    For i=0 To GridsList.ListCount-1            'for each row
		      
		      Dim i1 As Integer = Val(GridsList.Cell(i,0) )//tileX
		      Dim i2 As Integer = Val(GridsList.Cell(i,1)) //tileY
		      Dim i3 As Integer = Val(GridsList.Cell(i,2)) //rows
		      Dim i4 As Integer = Val(GridsList.Cell(i,3)) //cols 
		      Dim i5 As Integer = Val(GridsList.Cell(i,4)) //offsetX
		      Dim i6 As Integer = Val(GridsList.Cell(i,5)) //offsetY 
		      
		      Dim i7 As Integer = ((i1*i3)/3)//third of width 
		      Dim i8 As Integer = ((i2*i4)/3)//third of height 
		      
		      
		      
		      
		      
		      Dim p1 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i6)  +"""/>" +Chr(10)//TL
		      Dim p2 As String = "<v x=""" + Str(i5 + (i1*i3)) + """ y=""" + Str(i6) +"""/>"+Chr(10)//TR
		      Dim p3 As String = "<v x=""" + Str(i5 + (i1*i3)) + """ y=""" + Str(i6 + (i2 * i4) )+"""/>"+Chr(10)//BL
		      Dim p4 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i6 + (i2 * i4))+"""/>"+Chr(10)///BR
		      
		      s = RE2 + GridsList.Cell(i,6) + RE3
		      tos.WriteLine s                'save line
		      
		      s = p1 + p2 + p3 + p4
		      tos.WriteLine s                'save line
		      
		      s = "</InputRect>"
		      tos.WriteLine s                'save line
		      
		      s = "<OutputRect orientation=""0"">"
		      tos.WriteLine s                'save line
		      
		      s = p1 + p2 + p3 + p4
		      tos.WriteLine s                'save line
		      
		      s = RE3a
		      tos.WriteLine s                'save line
		      
		      
		      Dim b1 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i6)  +"""/>" +Chr(10)//TL
		      Dim b2 As String = "<v x=""" + Str(i7+i5) + """ y=""" + Str(i6)  +"""/>" +Chr(10)
		      Dim b3 As String = "<v x=""" + Str(i7*2+i5) + """ y=""" + Str(i6)  +"""/>" +Chr(10)
		      Dim b4 As String = "<v x=""" + Str(i7*3+i5) + """ y=""" + Str(i6)  +"""/>" +Chr(10)//TR
		      
		      Dim b5 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i8+i6)  +"""/>" +Chr(10)
		      Dim b6 As String = "<v x=""" + Str(i7+i5) + """ y=""" + Str(i8+i6)  +"""/>" +Chr(10)
		      Dim b7 As String = "<v x=""" + Str(i7*2+i5) + """ y=""" + Str(i8+i6)  +"""/>" +Chr(10)
		      Dim b8 As String = "<v x=""" + Str(i7*3+i5) + """ y=""" + Str(i8+i6)  +"""/>" +Chr(10)
		      
		      Dim b9 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i8*2+i6)  +"""/>" +Chr(10)
		      Dim b10 As String = "<v x=""" + Str(i7+i5) + """ y=""" + Str(i8*2+i6)  +"""/>" +Chr(10)
		      Dim b11 As String = "<v x=""" + Str(i7*2+i5) + """ y=""" + Str(i8*2+i6)  +"""/>" +Chr(10)
		      Dim b12 As String = "<v x=""" + Str(i7*3+i5) + """ y=""" + Str(i8*2+i6)  +"""/>" +Chr(10)
		      
		      Dim b13 As String = "<v x=""" + Str(i5) + """ y=""" + Str(i8*3+i6)  +"""/>" +Chr(10)//BL
		      Dim b14 As String = "<v x=""" + Str(i7+i5) + """ y=""" + Str(i8*3+i6)  +"""/>" +Chr(10)
		      Dim b15 As String = "<v x=""" + Str(i7*2+i5) + """ y=""" + Str(i8*3+i6)  +"""/>" +Chr(10)
		      Dim b16 As String = "<v x=""" + Str(i7*3+i5) + """ y=""" + Str(i8*3+i6)  +"""/>" +Chr(10)//BR
		      
		      s = b1+b2+b3+p2+b5+b6+b7+b8+b9+b10+b11+b12+p4+b14+b15+p3+RE3b
		      tos.WriteLine s              'save line
		      
		    Next
		    
		  End 
		  
		  s = RE4
		  tos.WriteLine s              'save line
		  
		  s = "<OutputDeviceVirtual name=""Screen 1"" deviceId=""VirtualScreen 1"" idHash=""10094742552620344504"" width=""" + OutH.Text  + """ height =""" + OutV.Text + """>"
		  tos.WriteLine s              'save line
		  
		  
		  s = "<Params name=""Params"">"
		  tos.WriteLine s              'save line
		  
		  s = "<ParamRange name=""Width"" default=""" + OutH.Text + """ value =""" + OutH.Text + """/>"
		  tos.WriteLine s              'save line
		  
		  
		  
		  s = "<ValueRange name=""defaultRange"" min=""1"" max=""16384""/>"
		  tos.WriteLine s              'save line
		  
		  s = "<ParamRange name=""Height"" default=""" +OutV.Text + """ value=""" + OutV.Text + """/>"
		  tos.WriteLine s              'save line
		  
		  s= RE5
		  tos.WriteLine s              'save line
		  
		  
		  
		  tos.Close                                                 'close file
		  
		  
		  f = f.Parent
		  'MsgBox(f.NativePath)
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub SaveFile()
		  //old version. no longer used
		  
		  
		  Dim f As folderitem
		  Dim tos As textOutputStream
		  dim s as string
		  dim i, j as integer
		  
		  'show standard file selector
		  f= GetSaveFolderItem(GridFileType.pg2,"Grid List "+CanvasText.text+".pg2")
		  if f = nil then exit sub                              'cancel clicked
		  
		  'create file
		  tos = f.CreateTextFile
		  if tos = nil then                                       'failed?
		    MsgBox("The file could not be created!")
		    exit sub
		  end if
		  
		  if GridsList.ListCount>0 then                   'if grid not empty
		    
		    s=Window1.OutH.Text+","+Window1.OutV.Text+","+Str(Window1.stats.Value)+","+Str(Window1.originCursor.Value)+","+Str(Window1.alt_text.Value)+"," +Str(ColorPicker.FillColor)+"," +Str(GridColour.Value)+"," + CanvasText.Text +","   + Str(TP) + "," +Str(col_alpha.ListIndex)+","+Str(dropShadow.Value)+"," 'exports canvas size and options
		    tos.WriteLine s.left(s.len-1)                'save line
		    for i=0 to GridsList.ListCount-1            'for each row
		      s=""                                                   'build line to save
		      for j=0 to 6   'for each column
		        s=s+GridsList.Cell(i,j)+ ","    'csv
		      Next
		      s=s+str(GridsList.celltag(i,7))+","
		      for j = 8 to 15
		        s=s+str(GridsList.cellcheck(i,j))+","
		      next
		      tos.WriteLine s.left(s.len-1)                'save line
		    next
		  end if
		  
		  Window1.Title="Editor - " + f.Name
		  
		  tos.Close                                                 'close file
		  
		  app.newChanges = False
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub SaveFileXml()
		  Dim xml As New XMLDocument
		  Dim root As XMLNode
		  Dim tos As textOutputStream
		  Dim i As Integer
		  
		  root = xml.AppendChild(xml.CreateElement("gridList")) 
		  
		  Dim canvas As XMLNode
		  canvas = root.AppendChild(xml.CreateElement("canvas"))
		  
		  canvas.SetAttribute("canvasName",CanvasText.Text)
		  canvas.SetAttribute("outH", Window1.OutH.Text)
		  canvas.SetAttribute("outV", Window1.OutV.Text)
		  canvas.SetAttribute("raster", Str(Window1.stats.Value))
		  canvas.SetAttribute("originCursor", Str(Window1.originCursor.Value))
		  canvas.SetAttribute("transparentCanvas", Str(Window1.T_Canvas.Value))
		  canvas.SetAttribute("largeText", Str(Window1.alt_text.Value))
		  canvas.SetAttribute("textColour", Str(ColorPicker.FillColor))
		  canvas.SetAttribute("colourGrid",Str(GridColour.Value))
		  canvas.SetAttribute("textPosition",Str(TP))
		  canvas.SetAttribute("colDtype",Str(col_alpha.ListIndex))
		  canvas.SetAttribute("dropShadow", Str(dropShadow.Value))
		  
		  Dim grid As XMLNode
		  
		  If GridsList.ListCount>0 Then                   'if grid not empty
		    
		    For i=0 To GridsList.ListCount-1            'for each row
		      
		      grid = canvas.AppendChild(xml.CreateElement("grid"))
		      
		      grid.SetAttribute("gridName",GridsList.Cell(i,6))
		      grid.SetAttribute("tileX",GridsList.Cell(i,0))
		      grid.SetAttribute("tileY",GridsList.Cell(i,1))
		      grid.SetAttribute("cols",GridsList.Cell(i,2))
		      grid.SetAttribute("rows",GridsList.Cell(i,3))
		      grid.SetAttribute("offX",GridsList.Cell(i,4))
		      grid.SetAttribute("offY",GridsList.Cell(i,5))
		      grid.SetAttribute("background",GridsList.celltag(i,7))
		      
		      grid.SetAttribute("grid",Str(GridsList.cellcheck(i,8)))
		      grid.SetAttribute("raster",Str(GridsList.cellcheck(i,9)))
		      grid.SetAttribute("tileID",Str(GridsList.cellcheck(i,10)))
		      grid.SetAttribute("circle",Str(GridsList.cellcheck(i,11)))
		      grid.SetAttribute("cross",Str(GridsList.cellcheck(i,12)))
		      grid.SetAttribute("corner",Str(GridsList.cellcheck(i,13)))
		      grid.SetAttribute("logo",Str(GridsList.cellcheck(i,14)))
		      grid.SetAttribute("colorBars",Str(GridsList.cellcheck(i,15)))
		      
		    Next
		  End If
		  
		  Dim prettyXML As String = xml.Transform(kPrettyPrintXSL)
		  Dim f As FolderItem
		  
		  
		  f = GetSaveFolderItem(GridFileType.pg3, "Grid List "+CanvasText.Text+".pg3")
		  tos = f.CreateTextFile
		  If f <> Nil Then
		    tos.Write(prettyXML)
		    tos.close
		    //xml.SaveXml(f)
		  End If
		  
		  Window1.Title="Editor - " + f.Name
		  
		  app.newChanges = False
		  
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub svgExport()
		  Dim f, f2 As folderitem
		  Dim tos As textOutputStream
		  Dim s As String
		  Dim i, j As Integer
		  
		  
		  
		  
		  'show standard file selector
		  f= GetSaveFolderItem(ExtendScript.svg,"SVG Export - "+CanvasText.Text+".svg")
		  If f = Nil Then Exit Sub                              'cancel clicked
		  
		  'create file
		  tos = f.CreateTextFile
		  If tos = Nil Then                                       'failed?
		    MsgBox("The file could not be created!")
		    Exit Sub
		  End If
		  
		  s = "<svg version=""1.1"" id=""layer"" xmlns=""http://www.w3.org/2000/svg"" xmlns:xlink=""http://www.w3.org/1999/xlink"""
		  
		  tos.WriteLine s                'save line
		  
		  s = "xml:space=""preserve"" x=""0"" y=""0"" width=""" + OutH.Text + """ height="""   + OutV.Text + """ viewBox=""0 0 " + OutH.Text + " " + OutV.Text + """>"
		  
		  tos.WriteLine s                'save line
		  
		  
		  If GridsList.ListCount>0 Then                   'if grid not empty
		    For i=0 To GridsList.ListCount-1            'for each row
		      Dim i1 As Integer = Val(GridsList.Cell(i,0) )//tileX
		      Dim i2 As Integer = Val(GridsList.Cell(i,1)) //tileY
		      Dim i3 As Integer = Val(GridsList.Cell(i,2)) //rows
		      Dim i4 As Integer = Val(GridsList.Cell(i,3)) //cols 
		      Dim i5 As Integer = Val(GridsList.Cell(i,4)) //offsetX
		      Dim i6 As Integer = val(GridsList.Cell(i,5)) //offsetY 
		      
		      
		      
		      Dim p1 As String = Str(i5) + " " + Str(i6)  +" " //TL
		      Dim p2 As String = Str(i5 + (i1*i3)) + " " + Str(i6) +" "//TR
		      Dim p3 As String = Str(i5 + (i1*i3)) + " " + Str(i6 + (i2 * i4) )+" "//BL
		      Dim p4 As String = Str(i5) + " " + Str(i6 + (i2 * i4))//BR
		      
		      //<polygon id="Surface A" fill="#FFFF00" points="320 180 1600 180 1600 900 320 900 "></polygon>
		      s =  "<polygon id="""+ GridsList.Cell(i,6)  + """ fill=""#"+ Hex( Rnd * 255)+ Hex( Rnd * 255)+Hex( Rnd * 255)+""" points="""+p1+p2+p3+p4+"""></polygon>"
		      
		      
		      tos.WriteLine s              'save line
		    Next
		    
		  End 
		  
		  s = "</svg>"
		  tos.WriteLine s              'save line
		  
		  tos.Close                                                 'close file
		  
		  
		  f = f.Parent
		  'MsgBox(f.NativePath)
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub UpdateScreen()
		  
		  'debug.log("UpDateScreen")
		  
		  if GridsList.ListCount>0 then
		    
		    rebuild=true
		    
		    
		    if GorC then
		      OutCanvasUpdate()
		      Window1.Canvas1.Refresh
		    else
		      Window1.Canvas1.Refresh
		      'OutCanvasUpdate()
		    end
		    
		    if OutputIsOpen  then
		      OutCanvasUpdate()
		      Window2.Canvas1.Refresh
		    end
		    
		  end
		End Sub
	#tag EndMethod


	#tag Property, Flags = &h0
		CanvasHmargin As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		CanvasVMargin As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		column As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		edit As Boolean = false
	#tag EndProperty

	#tag Property, Flags = &h0
		GorC As Boolean = false
	#tag EndProperty

	#tag Property, Flags = &h0
		icon As Picture
	#tag EndProperty

	#tag Property, Flags = &h0
		maxWinHeight As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		maxWinWidth As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mHorizontalScrollBarLast As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mOldX As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mOldY As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		mScale As Double = 54
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mVerticalScrollBarLast As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mXScroll As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		myPic As Picture
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mYScroll As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		OutCanvas As Picture
	#tag EndProperty

	#tag Property, Flags = &h0
		OutputIsOpen As Boolean = false
	#tag EndProperty

	#tag Property, Flags = &h0
		PicIndex As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h0
		rebuild As Boolean = false
	#tag EndProperty

	#tag Property, Flags = &h0
		row As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Private scaledHeight As Integer = 1
	#tag EndProperty

	#tag Property, Flags = &h21
		Private scaledWidth As Integer = 1
	#tag EndProperty

	#tag Property, Flags = &h21
		Private TextXPos As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h21
		Private TextYPos As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h0
		TP As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h21
		Private Untitled As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		withGrids As Boolean = false
	#tag EndProperty


	#tag Constant, Name = AE1, Type = String, Dynamic = False, Default = \"{\n  // Script generated from pixl Grid Multi\n  // www.pixlevolution.com/\n  // Create script undo group\n\n  app.beginUndoGroup(\"Create Grids\");\n\n  // create project if necessary\n\n  var proj \x3D app.project;\n  if(!proj) proj \x3D app.newProject();\n\n  //Canvas\n\n  var compW \x3D ", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE1a, Type = String, Dynamic = False, Default = \"; // comp height\n  var compL \x3D ", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE1b, Type = String, Dynamic = False, Default = \";  // comp length (seconds)\n  var compRate \x3D ", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE2, Type = String, Dynamic = False, Default = \"; // comp frame rate\n  var compBG \x3D [48/255\x2C63/255\x2C84/255] // comp background color\n  \n  var myItemCollection \x3D app.project.items;\n  var canvas \x3D myItemCollection.addComp(\'", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE2a, Type = String, Dynamic = False, Default = \"\'\x2CcompW\x2CcompH\x2C1\x2CcompL\x2CcompRate);\n  canvas.bgColor \x3D compBG;\n\n  var backgroundLayer \x3D canvas.layers.addSolid([0/255\x2C0/255\x2C0/255]\x2C \"Background\"\x2C compW\x2C compH\x2C 1)\n", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3, Type = String, Dynamic = False, Default = \"; // comp height\n\n  \n  \n  var myItemCollection \x3D app.project.items;\n  var grid \x3D myItemCollection.addComp(\'", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3a, Type = String, Dynamic = False, Default = \"\'\x2CcompW\x2CcompH\x2C1\x2CcompL\x2CcompRate);\n  \n  var backgroundLayer \x3D grid.layers.addSolid([", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3b, Type = String, Dynamic = False, Default = \"]\x2C \"Background\"\x2C compW\x2C compH\x2C 1);", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3c, Type = String, Dynamic = False, Default = \"  var gridimport \x3D app.project.importFile(new ImportOptions(new File(\"", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3d, Type = String, Dynamic = False, Default = \"\")));\n  var gridlayer \x3D grid.layers.add(gridimport);", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE3e, Type = String, Dynamic = False, Default = \"  var mylayer \x3D canvas.layers.add(grid);\n  var myPosition \x3D mylayer.property(\"position\");\n  var myAnchor \x3D mylayer.property(\"anchorPoint\");\n  myAnchor.setValue([0\x2C0]);\n  myPosition.setValue([", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE4, Type = String, Dynamic = False, Default = \"  var gridimport \x3D app.project.importFile(new ImportOptions(new File(\"", Scope = Public
	#tag EndConstant

	#tag Constant, Name = AE4b, Type = String, Dynamic = False, Default = \"\")));\n  var mylayer \x3D canvas.layers.add(gridimport);\n  var myPosition \x3D mylayer.property(\"position\");\n  var myAnchor \x3D mylayer.property(\"anchorPoint\");\n  myAnchor.setValue([0\x2C0]);\n  myPosition.setValue([0\x2C0]);\n", Scope = Public
	#tag EndConstant

	#tag Constant, Name = kPrettyPrintXSL, Type = String, Dynamic = False, Default = \"<\?xml version\x3D\"1.0\" encoding\x3D\"UTF-8\"\?>\n<xsl:transform version\x3D\"1.0\" xmlns:xsl\x3D\"http://www.w3.org/1999/XSL/Transform\">\n\t<xsl:output method\x3D\"xml\" indent\x3D\"yes\" />\n\t<xsl:template match\x3D\"/\">\n\t\t<xsl:copy-of select\x3D\"/\" />\n\t</xsl:template>\n</xsl:transform>", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE1, Type = String, Dynamic = False, Default = \"<\?xml version\x3D\"1.0\" encoding\x3D\"utf-8\"\?>\n<XmlState name\x3D\"Test\">\n<versionInfo name\x3D\"Resolume Arena\" majorVersion\x3D\"6\" minorVersion\x3D\"1\" microVersion\x3D\"0\" revision\x3D\"61231\"/>\n<ScreenSetup name\x3D\"ScreenSetup\">\n<Params name\x3D\"ScreenSetupParams\"/>\n<screens>\n<Screen name\x3D\"Screen 1\" uniqueId\x3D\"1540993259468\">\n\n\n<layers>\n", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE2, Type = String, Dynamic = False, Default = \"<Slice >\n\t\t\t\t\t\t<Params name\x3D\"Common\">\n\t\t\t\t\t\t\t<Param name\x3D\"Name\" default\x3D\"Layer\" value\x3D\"", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE3, Type = String, Dynamic = False, Default = \"\"/>\n\n\t\t\t\t\t\t</Params>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t<InputRect orientation\x3D\"0\">\n", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE3a, Type = String, Dynamic = False, Default = \"</OutputRect>\n\t\t\t\t\t\t<Warper>\n\t\t\t\t\t\t\t<Params name\x3D\"Warper\">\n\t\t\t\t\t\t\t\t<ParamChoice name\x3D\"Point Mode\" default\x3D\"PM_LINEAR\" value\x3D\"PM_LINEAR\" storeChoices\x3D\"0\"/>\n\t\t\t\t\t\t\t\t<Param name\x3D\"Flip\" default\x3D\"0\" value\x3D\"0\"/>\n\t\t\t\t\t\t\t</Params>\n\t\t\t\t\t\t\t<BezierWarper controlWidth\x3D\"4\" controlHeight\x3D\"4\">\n\t\t\t\t\t\t\t\t<vertices>", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE3b, Type = String, Dynamic = False, Default = \"</vertices>\n\t\t\t\t\t\t\t</BezierWarper>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</Warper>\n\t\t\t\t\t</Slice>", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE4, Type = String, Dynamic = False, Default = \"</layers>\n\t\t\t\t<OutputDevice>", Scope = Public
	#tag EndConstant

	#tag Constant, Name = RE5, Type = String, Dynamic = False, Default = \"</Params>\n\t\t\t\t\t</OutputDeviceVirtual>\n\t\t\t\t</OutputDevice>\n\t\t\t</Screen>\n\t\t</screens>\n\t\n\t</ScreenSetup>\n</XmlState>\n", Scope = Public
	#tag EndConstant


#tag EndWindowCode

#tag Events Canvas1
	#tag Event
		Sub Paint(g As Graphics, areas() As REALbasic.Rect)
		  // debugWindow.Log("Paint "+ Str(rebuild))
		  
		  
		  Dim gridColour,gC As Color
		  
		  If IsDarkMode Then
		    gridColour = &c16161600
		  Else
		    gridColour = &c21212100
		  End If
		  
		  
		  
		  Dim i,j,k As Integer = 0
		  For j = 0 To Self.height Step 10
		    
		    If (j/10)  Mod 2 = 0 Then
		      k = 0
		    Else
		      k = 10
		    End
		    
		    For i = k To Self.width Step 20
		      g.ForeColor= gridColour
		      g.FillRect(i,j,10,10)
		      g.ForeColor= &c12121200
		      g.FillRect(i-10,j,10,10)
		      
		    Next i
		    
		  Next j
		  
		  
		  
		  if rebuild then
		    BuildGrid(PicIndex)
		  end
		  
		  if GorC = false then
		    scaledWidth  = MyPic.width * (mscale/100)
		    scaledHeight = MyPic.height * (mscale/100)
		    
		    // Size the scrollbar based on how much vertical scrolling the image can do
		    VerticalScrollBar.Maximum = scaledHeight - me.Height
		    
		    // Disable scrollbar if image is shorter than canvas area since there
		    // is nothing to scroll
		    If me.Height >= scaledHeight Then
		      VerticalScrollBar.Visible = False
		      mYScroll = 0
		    Else
		      'check if ScrollBar is visible already. If just appearing then reset mYScroll
		      
		      if VerticalScrollBar.Visible then
		        
		      else
		        VerticalScrollBar.Visible = True
		        mYScroll = 0
		      end
		      
		    End If
		    
		    // Size the scrollbar based on how much horizontal scrolling the image can do
		    HorizontalScrollBar.Maximum = scaledWidth - me.Width
		    
		    // Disable scrollbar if image is narrower than canvas area since there
		    // is nothing to scroll
		    If me.Width >= scaledWidth Then
		      HorizontalScrollBar.Visible = False 
		      mXScroll = 0
		    Else
		      
		      // check if ScrollBar is visible already. If just appearing then reset mXScroll
		      
		      if HorizontalScrollBar.Visible then
		        
		      else
		        HorizontalScrollBar.Visible = True
		        
		        mXScroll = 0
		      end
		      
		    End If
		    
		    g.DrawPicture(MyPic, mXScroll, mYScroll,scaledWidth,scaledHeight,0,0,MyPic.width,MyPic.height)
		    
		    
		  else
		    scaledWidth  = OutCanvas.width * (mscale/100)
		    scaledHeight = OutCanvas.height * (mscale/100)
		    
		    // Size the scrollbar based on how much vertical scrolling the image can do
		    VerticalScrollBar.Maximum = scaledHeight - me.Height
		    
		    // Disable scrollbar if image is shorter than canvas area since there
		    // is nothing to scroll
		    If me.Height >= scaledHeight Then
		      VerticalScrollBar.Visible = False
		      mYScroll = 0
		    Else
		      // check if ScrollBar is visible already. If just appearing then reset mYScroll
		      
		      if VerticalScrollBar.Visible then
		      else
		        VerticalScrollBar.Visible = True
		        mYScroll = 0
		      end
		      
		    End If
		    
		    // Size the scrollbar based on how much horizontal scrolling the image can do
		    HorizontalScrollBar.Maximum = scaledWidth - me.Width
		    
		    // Disable scrollbar if image is narrower than canvas area since there
		    // is nothing to scroll
		    
		    
		    If me.Width >= scaledWidth Then
		      HorizontalScrollBar.Visible = False 
		      mXScroll = 0
		    Else
		      
		      // check if ScrollBar is visible already. If just appearing then reset mXScroll
		      
		      if HorizontalScrollBar.Visible then
		      else
		        HorizontalScrollBar.Visible = True
		        mXScroll = 0
		      end
		      
		    End If
		    
		    g.DrawPicture(OutCanvas, mXScroll, mYScroll,scaledWidth,scaledHeight,0,0,OutCanvas.width,OutCanvas.height)
		    
		    
		  end 
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Sub MouseDrag(X As Integer, Y As Integer)
		  'if canvas then
		  'if X > left of title and < left + width of title then
		  'if Y > top of title and < top + height of title then
		  'titleX = X
		  'end if
		  
		  'end if 
		  
		  'else
		  
		  If X <> mOldX Or y <> mOldY Then
		    // If the mouse has been moved, calculate the delta
		    // and scroll the image.
		    
		    Dim dx As Integer = X - mOldX
		    Dim dy As Integer = Y - mOldY
		    
		    // Only allow image to be scrolled right and down
		    If HorizontalScrollBar.Value - dx < 0 Then Return
		    If VerticalScrollBar.Value - dy < 0 Then Return
		    
		    // Don't allow image to be scrolled beyond its size
		    If HorizontalScrollBar.Value - dx > HorizontalScrollBar.Maximum Then Return
		    If VerticalScrollBar.Value - dx > VerticalScrollBar.Maximum Then Return
		    
		    // Adjust scrollbars which will scroll image 
		    HorizontalScrollBar.Value = HorizontalScrollBar.Value - dx
		    VerticalScrollBar.Value = VerticalScrollBar.Value - dy
		    
		    mOldX = X
		    mOldY = Y
		    
		  End If
		  
		  
		  'end if
		End Sub
	#tag EndEvent
	#tag Event
		Function MouseDown(X As Integer, Y As Integer) As Boolean
		  // Save the last mouse coordinates so we can
		  // calculate if the mouse has moved.
		  
		  mOldX = X
		  mOldY = Y
		  
		  Return True
		End Function
	#tag EndEvent
	#tag Event
		Function MouseWheel(X As Integer, Y As Integer, deltaX as Integer, deltaY as Integer) As Boolean
		  
		  // If the mousewheel is moved over the Canvas, then
		  // use the delta to adjust the scrollbars, which
		  // scrolls the image.
		  
		  VerticalScrollBar.Value = VerticalScrollBar.Value + deltaY
		  HorizontalScrollBar.Value = HorizontalScrollBar.Value +deltaX
		End Function
	#tag EndEvent
	#tag Event
		Function KeyDown(Key As String) As Boolean
		  Const kLeftArrow = 28
		  Const kRightArrow = 29
		  Const kUpArrow = 30
		  Const kDownArrow = 31
		  Const kScrollUnit = 8 // pixels to scroll per keypress
		  
		  
		  // Move the scrollbar based on the key that was pressed
		  Select Case Asc(Key)
		  Case kLeftArrow
		    HorizontalScrollBar.Value = HorizontalScrollBar.Value - kScrollUnit
		    
		  Case kRightArrow
		    HorizontalScrollBar.Value = HorizontalScrollBar.Value + kScrollUnit
		    
		  Case kUpArrow
		    VerticalScrollBar.Value = VerticalScrollBar.Value - kScrollUnit
		    
		  Case kDownArrow
		    VerticalScrollBar.Value = VerticalScrollBar.Value + kScrollUnit
		    
		    
		    
		  End Select
		  
		  Return True
		  
		End Function
	#tag EndEvent
	#tag Event
		Sub Open()
		  
		  #If TargetWin32 Then
		    Me.DoubleBuffer = True
		  #Else
		    Me.DoubleBuffer = False
		  #Endif
		  Me.EraseBackground = False
		  
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events VerticalScrollBar
	#tag Event
		Sub ValueChanged()
		  // Calculate the delta that the scrollbar was
		  // moved and scroll the image accordingly.
		  
		  Dim delta As Integer
		  delta = mVerticalScrollBarLast - Me.Value
		  mYScroll = mYScroll + delta
		  
		  Canvas1.Scroll(0, delta)
		  
		  mVerticalScrollBarLast = Me.Value
		End Sub
	#tag EndEvent
	#tag Event
		Function MouseWheel(X As Integer, Y As Integer, deltaX as Integer, deltaY as Integer) As Boolean
		  // If the mouse wheel is moved, adjust the scrollbar
		  // by the delta.
		  
		  Me.Value = Me.Value + deltaY
		  
		  Return True
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events HorizontalScrollBar
	#tag Event
		Sub ValueChanged()
		  
		  'debug.log("H delta")
		  
		  // Calculate the delta that the scrollbar was
		  // moved and scroll the image accordingly.
		  
		  Dim delta As Integer
		  delta = mHorizontalScrollBarLast - Me.Value
		  mXScroll = mXScroll + delta
		  
		  Canvas1.Scroll(delta, 0)
		  
		  mHorizontalScrollBarLast = Me.Value
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Scale
	#tag Event
		Sub Down()
		  dim a as integer
		  
		  a = mscale\5
		  mscale = a *5
		  
		  if mscale > 0 then
		    mScale = mScale-5
		    
		    
		    rebuild=false
		    
		    Window1.Canvas1.Refresh
		    
		  else 
		    Window1.mScale = 0
		    
		  end if
		  
		  zoom.Text=str(mScale)+"%"
		End Sub
	#tag EndEvent
	#tag Event
		Sub Up()
		  dim a as integer
		  
		  a = mscale\5
		  mscale = a *5
		  
		  
		  mScale = mScale+5
		  rebuild=false
		  'UpdateScreen()
		  Window1.Canvas1.Refresh
		  
		  zoom.Text=str(mScale)+"%"
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events OutH
	#tag Event
		Sub LostFocus()
		  If Val(Me.Text) > 32767 Then
		    MsgBox("Too Big!")
		    me.Text = str(32767)
		    
		  elseif val(me.text) <1 then
		    MsgBox("Too Small")
		    me.Text = "1"
		    
		    
		  end
		  
		  
		  UpdateScreen
		  
		  'app.newChanges = True
		  'debugWindow.log("newChanges hlost")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events OutV
	#tag Event
		Sub LostFocus()
		  If Val(Me.Text) > 32767 Then
		    MsgBox("Too Big!")
		    me.Text = str(32767)
		    
		  elseif val(me.text) <1 then
		    MsgBox("Too Small")
		    me.Text = "1"
		    
		    
		  end
		  UpdateScreen
		  
		  'app.newChanges = True
		  'debugWindow.log("newChanges v lost")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events stats
	#tag Event
		Sub Action()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges stats")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Hscroll
	#tag Event
		Sub Action()
		  
		  
		  If Me.value Then
		    If Window1.CursorColour.Value Then
		      window2.Hcolour = &cff0000
		    Else 
		      window2.Hcolour = &cffffff
		    End
		  Else
		    window2.Hcolour = &c000000
		    
		  End
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Vscroll
	#tag Event
		Sub Action()
		  If Me.value Then
		    If Window1.CursorColour.Value Then
		      Window2.Vcolour = &c00ff00
		    Else 
		      Window2.Vcolour= &cffffff
		    End
		  Else
		    window2.Vcolour = &c000000
		  End
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SpeedSlide
	#tag Event
		Sub ValueChanged()
		  Window2.speed= me.Value
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Live3
	#tag Event
		Sub Action()
		  if OutputIsOpen then
		    window2.close
		  else
		    
		    Window2.show
		  end
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SizeSlide
	#tag Event
		Sub ValueChanged()
		  window2.size=me.value
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events CursorColour
	#tag Event
		Sub Action()
		  If Me.Value Then
		    Window2.Vcolour = &c00ff00
		    Window2.Hcolour = &cff0000
		  Else 
		    Window2.Vcolour= &cffffff
		    Window2.Hcolour = &cffffff
		  End
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events AddGrid
	#tag Event
		Sub Action()
		  //dim previousList as integer
		  
		  if GridsList.Listindex <> -1 then //is a row selected, then copy values
		    
		    for j as integer= 0 to GridsList.listcount-1 
		      if GridsList.selected(j) then
		        
		        //previousList = j
		        GridsList.AddRow()
		        for i as integer = 0 to 6
		          GridsList.cell(GridsList.Lastindex,i)=GridsList.cell(j,i)
		        next
		        GridsList.celltag(GridsList.Lastindex,7)=GridsList.celltag(j,7)
		        for i as integer = 8 to 15
		          GridsList.cellcheck(GridsList.Lastindex,i)=GridsList.cellcheck(j,i)
		        next
		        
		        
		      end if
		    next
		    
		    
		    
		  else      //if not selcted then copy position 1
		    
		    
		    GridsList.AddRow()
		    for i as integer = 0 to 6
		      GridsList.cell(GridsList.Lastindex,i)=GridsList.cell((GridsList.Lastindex-1),i)
		    next
		    GridsList.celltag(GridsList.Lastindex,7)=GridsList.celltag((GridsList.Lastindex-1),7)
		    for i as integer = 8 to 15
		      GridsList.cellcheck(GridsList.Lastindex,i)=GridsList.cellcheck((GridsList.Lastindex-1),i)
		    next
		    
		  end
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges add grid")
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events GridsList
	#tag Event
		Sub Open()
		  dim i as integer
		  
		  
		  
		  Dim values() As String = Array(Preferences.defTileX,Preferences.defTileY,"15","4","336","168","Screen One") 'startup values
		  Me.AddRow(values)
		  
		  me.Celltag(0,7)="25% Colour"
		  
		  for i = 0 to 7
		    Me.ColumnType(2) = ListBox.TypeEditableTextField
		  next
		  
		  for i = 8 to 15   
		    Me.ColumnType(i) = ListBox.TypeCheckbox
		    me.CellCheck(0,i)=true
		  next
		  
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Function CellClick(row as Integer, column as Integer, x as Integer, y as Integer) As Boolean
		  'MsgBox("Cell Click")
		  'UpdateScreen()
		  'if edit then
		  'Me.EditCell(row, column)
		  'edit = false
		  'end
		  
		  self.row = row
		  self.column = Column
		  
		End Function
	#tag EndEvent
	#tag Event
		Sub Change()
		  app.newChanges = True
		  debugWindow.log("newChangesgrid change")
		  
		  if me.ListIndex <> -1 then
		    PicIndex=me.ListIndex
		    SaveAsGrid.Caption="Save Grid As.."
		    SaveAsCanvas.Caption="Save Canvas As.."
		    AddGrid.Caption = "Copy Grid.."
		    deselectLabel.Visible = true
		  else
		    AddGrid.Caption = "Add Grid.."
		    SaveAsGrid.Caption="Save All Grids As.."
		    
		    if Grid_Solo.value then
		      SaveAsCanvas.Caption="Save Canvas As.."
		    end
		    deselectLabel.Visible = false
		    
		  end
		  
		  UpdateScreen()
		  
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Sub DoubleClick()
		  
		  if column <8 then
		    Me.EditCell(row, column)
		    
		  end
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean
		  '// Highlight ever other row
		  '
		  If IsDarkMode Then
		    If row Mod 2 = 0 Then
		      g.ForeColor =&c19191900
		      g.FillRect(0, 0, g.Width, g.Height)
		    End If
		    
		    
		  Else
		    
		    
		    If row Mod 2 = 0 Then
		      g.ForeColor = &c222222
		      g.FillRect(0, 0, g.Width, g.Height)
		    Else
		      g.ForeColor = &c262626
		      g.FillRect(0, 0, g.Width, g.Height)
		    End If
		    
		    
		  End
		End Function
	#tag EndEvent
	#tag Event
		Sub MouseUp(x As Integer, y As Integer)
		  Dim row As Integer = Me.RowFromXY(x, y)
		  Dim col As Integer = Me.ColumnFromXY(x, y)
		  
		  If col = 7 Then
		    Me.ListIndex = row
		    Me.Selected(row) = True
		    
		    Dim base As New MenuItem
		    base.Append(New MenuItem("100% Colour"))
		    base.Append(New MenuItem("50% Colour"))
		    base.Append(New MenuItem("25% Colour"))
		    base.Append(New MenuItem("White"))
		    base.Append(New MenuItem("Gray"))
		    base.Append(New MenuItem("Black"))
		    base.Append(New MenuItem("Grayscale V"))
		    base.Append(New MenuItem("Grayscale H"))
		    base.Append(New MenuItem("Light Gray/Dark Gray"))
		    base.Append(New MenuItem("Reduced/Full Check"))
		    base.Append(New MenuItem("Black/White"))
		    base.Append(New MenuItem("Transparent"))
		    base.Append(New MenuItem("Red"))
		    base.Append(New MenuItem("Red/Gray"))
		    base.Append(New MenuItem("Alt Red"))
		    base.Append(New MenuItem("Full Red"))
		    base.Append(New MenuItem("Green"))
		    base.Append(New MenuItem("Green/Gray"))
		    base.Append(New MenuItem("Alt Green"))
		    base.Append(New MenuItem("Full Green"))
		    base.Append(New MenuItem("Blue"))
		    base.Append(New MenuItem("Blue/Gray"))
		    base.Append(New MenuItem("Alt Blue"))
		    base.Append(New MenuItem("Full Blue"))
		    base.Append(New MenuItem("Yellow"))
		    base.Append(New MenuItem("Yellow/Gray"))
		    base.Append(New MenuItem("Orange"))
		    base.Append(New MenuItem("Orange/Gray"))
		    base.Append(New MenuItem("Aqua"))
		    base.Append(New MenuItem("Aqua/Gray"))
		    base.Append(New MenuItem("Purple"))
		    base.Append(New MenuItem("Purple/Gray"))
		    base.Append(New MenuItem("Red/Green"))
		    base.Append(New MenuItem("Green/Blue"))
		    base.Append(New MenuItem("Blue/Red"))
		    base.Append(New MenuItem("Cyan"))
		    base.Append(New MenuItem("Magenta"))
		    base.Append(New MenuItem("Rainbow"))
		    base.Append(New MenuItem("Fruit"))
		    base.Append(New MenuItem("Veg"))
		    base.Append(New MenuItem("Camouflauge"))
		    
		    Dim selectedMenu As MenuItem
		    selectedMenu = base.PopUp
		    
		    If selectedMenu <> Nil Then
		      // CellTextPaint will check for a value in the CellTag
		      // and display it.
		      Me.CellTag(row, col) = selectedMenu.Text
		      UpdateScreen
		      Me.InvalidateCell(row, 7)
		    End If
		  End If
		  
		  
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Function MouseDown(x As Integer, y As Integer) As Boolean
		  If Me.ColumnFromXY(x, y) = 7 Then
		    Return True
		  End If
		End Function
	#tag EndEvent
	#tag Event
		Function CellTextPaint(g As Graphics, row As Integer, column As Integer, x as Integer, y as Integer) As Boolean
		  If Not IsDarkMode Then 
		    g.ForeColor = &cffffff
		  End
		  
		  
		  Select Case column
		  Case 7 // PopupMenu
		    // Draw an arrow to indicate that clicking this field will
		    // display a menu
		    
		    
		    
		    // Points for a triangle on the right side of the cell
		    Dim points(6) As Integer
		    points(1) = g.Width - 10
		    points(2) = 1
		    points(3) = g.Width
		    points(4) = 1
		    points(5) = g.Width - 5
		    points(6) = 10
		    
		    g.FillPolygon(points)
		    
		    If Me.CellTag(row, column) <> "" Then
		      g.DrawString(Me.CellTag(row, column), x, y)
		    Else
		      g.DrawString("25% Colour", x, y)
		    End If
		    
		    Return True
		  end select
		End Function
	#tag EndEvent
	#tag Event
		Sub CellAction(row As Integer, column As Integer)
		  app.newChanges = True
		  debugWindow.log("newChanges cell action")
		  
		  select case column
		    
		  Case 0 //tileX
		    if (val(GridsList.cell(row,0))*val(GridsList.cell(row,2))) >  32767 then
		      MsgBox("Too Big!")
		      GridsList.cell(row,0) = str((32767\val(GridsList.cell(row,2)))-1)
		    elseif (val(GridsList.cell(row,0))) <1 then
		      GridsList.cell(row,0) = "1"
		      MsgBox("Too Small")
		    end 
		  Case 1 //tileY
		    if (val(GridsList.cell(row,1))*val(GridsList.cell(row,3))) >  32767 then
		      MsgBox("Too Big!")
		      GridsList.cell(row,1) = str((32767\val(GridsList.cell(row,3)))-1)
		    elseif (val(GridsList.cell(row,1))) <1 then
		      MsgBox("Too Small")
		      GridsList.cell(row,1) = "1"
		    end 
		    
		  Case 2 //cols
		    if (val(GridsList.cell(row,0))*val(GridsList.cell(row,2))) >  32767 then
		      MsgBox("Too Big!")
		      GridsList.cell(row,2) = str((32767\val(GridsList.cell(row,0)))-1)
		    elseif (val(GridsList.cell(row,2))) <1 then
		      MsgBox("Too Small")
		      GridsList.cell(row,2) = "1"
		    end if
		    
		  Case 3 //rows
		    if (val(GridsList.cell(row,1))*val(GridsList.cell(row,3))) >  32767 then
		      MsgBox("Too Big!")
		      GridsList.cell(row,3) = str((32767\val(GridsList.cell(row,1)))-1)
		    elseif (val(GridsList.cell(row,3))) <1 then
		      MsgBox("Too Small")
		      GridsList.cell(row,3) = "1"
		    End If
		    
		  Case 4 //OffsetX
		    
		    If Right(GridsList.cell(row,4),1) = "t" Then
		      
		      GridsList.cell(row,4) = Str(Val(GridsList.cell(row,4)) * Val(GridsList.cell(row,0)))
		      
		    End If
		    
		  Case 5 //OffsetY
		    If Right(GridsList.cell(row,5),1) = "t" Then
		      
		      GridsList.cell(row,5) = Str(Val(GridsList.cell(row,5)) * Val(GridsList.cell(row,1)))
		      
		    End If
		    
		  else
		    UpdateScreen()
		    'If Me.CellCheck(row, column) Then
		    'UpdateScreen()
		    'Else
		    'UpdateScreen()
		    'End If
		  end select
		  me.Refresh
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Function CellKeyDown(row as Integer, column as Integer, key as String) As Boolean
		  if Keyboard.ShiftKey = false and asc(key) = 9 then
		    // here you find the next cell to make editable, and use editCell on it
		    
		    if column <6 then
		      me.EditCell(row, column+1)
		      return true
		    end
		  elseif  Keyboard.ShiftKey  and asc(key) = 9 Then
		    if column <6  and column > 0 then
		      me.EditCell(row, column-1)
		      return true
		    end
		    
		  elseif asc(key) = 13 then
		    if Keyboard.AsyncShiftKey then
		      if row > 0 then
		        me.editcell(row - 1, column)
		        return true
		      end if
		    else
		      if row < me.ListCount - 1 then
		        me.editcell(row + 1, column)
		        return true
		      end if
		    end if
		  else
		    return false
		  end if
		  
		  
		  
		  
		  
		End Function
	#tag EndEvent
	#tag Event
		Function KeyDown(Key As String) As Boolean
		  if asc(key) =8 or asc(key) = 127 then
		    DeleteList()
		    return true
		  end
		  
		  return false
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events DeleteGrid
	#tag Event
		Sub Action()
		  DeleteList()
		  
		  
		  'if GridsList.listcount >1 Then
		  '
		  'if GridsList.ListIndex <> -1 then
		  'if GridsList.ListIndex = 0 then
		  'GridsList.removeRow(GridsList.ListIndex)
		  'else
		  'GridsList.Selected(GridsList.ListIndex-1) = True
		  'GridsList.removeRow(GridsList.ListIndex+1)
		  'end
		  'UpdateScreen()
		  'else
		  'MsgBox("Please select grid to Delete")
		  'end
		  '
		  'else
		  'MsgBox("Must have one grid")
		  'end
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events GridCanvas_select
	#tag Event
		Sub Action(itemIndex as integer)
		  If itemIndex = 0  And GorC = True Then
		    GorC = false
		    Grid_Solo.Visible = False
		    MaskMode.Visible = false
		    stats.Visible = false
		    statsText.Visible = false
		    originCursor.Visible = false
		    originText.Visible = false
		    T_Canvas.Visible = false
		    T_CanvasText.Visible = false
		    TextPos.Visible = False
		    LabelClass01.Visible=False
		    LabelClass02.Visible=False
		    
		    'UpdateScreen       'added 14/10
		    
		  Elseif itemindex = 1 and GorC = false then
		    GorC = true
		    Grid_Solo.Visible = True
		    MaskMode.Visible = true
		    stats.Visible = true
		    statsText.Visible = true
		    originCursor.Visible = true
		    originText.Visible = true
		    T_Canvas.Visible = true
		    T_CanvasText.Visible = true
		    TextPos.Visible = true
		    // T_Canvas.value = Preferences.Tcanvas
		    LabelClass01.Visible=True
		    LabelClass02.Visible=True
		    
		    'OutCanvasUpdate().        removed 14/10
		    
		  End If
		  UpdateScreen()
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events originCursor
	#tag Event
		Sub Action()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges origin cursor")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SaveList
	#tag Event
		Sub Action()
		  SaveFile()
		  
		  
		  'dim f as folderitem
		  'dim tos as textOutputStream
		  'dim s as string
		  'dim i, j as integer
		  '
		  ''show standard file selector
		  'f= GetSaveFolderItem(GridFileType.pg2,"Grid List"+".pg2")
		  'if f = nil then exit sub                              'cancel clicked
		  '
		  ''create file
		  'tos = f.CreateTextFile
		  'if tos = nil then                                       'failed?
		  'MsgBox("The file could not be created!")
		  'exit sub
		  'end if
		  '
		  'if GridsList.ListCount>0 then                   'if grid not empty
		  '
		  's=Window1.OutH.Text+","+Window1.OutV.text+","+str(Window1.stats.Value)+","+str(Window1.originCursor.Value)+","+str(Window1.alt_text.Value)+"," +str(ColorPicker.FillColor)+","        'exports canvas size and options
		  'tos.WriteLine s.left(s.len-1)                'save line
		  'for i=0 to GridsList.ListCount-1            'for each row
		  's=""                                                   'build line to save
		  'for j=0 to 6   'for each column
		  's=s+GridsList.Cell(i,j)+ ","    'csv
		  'next
		  's=s+str(GridsList.celltag(i,7))+","
		  'for j = 8 to 15
		  's=s+str(GridsList.cellcheck(i,j))+","
		  'next
		  'tos.WriteLine s.left(s.len-1)                'save line
		  'next
		  'end if
		  '
		  'tos.Close                                                 'close file
		  '
		  '
		  '
		  '
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events LoadList
	#tag Event
		Sub Action()
		  LoadFile
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events alt_text
	#tag Event
		Sub Action()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges alt text")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SaveAsCanvas
	#tag Event
		Sub Action()
		  Dim f As FolderItem
		  OutCanvasUpdate()
		  if Grid_Solo.value and GridsList.ListIndex <> -1 then
		    f = GetSaveFolderItem(ImageFileTypeSet.Png, ("Canvas-" +CanvasText.text+" "+GridsList.cell(GridsList.ListIndex,6)+"-"+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) +".png"))
		  elseif Grid_Solo.value = false and MaskMode.value then
		    
		    f = GetSaveFolderItem(ImageFileTypeSet.Png, ("Canvas-Mask-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) +".png"))
		    
		  else
		    f = GetSaveFolderItem(ImageFileTypeSet.Png, ("Canvas-" +CanvasText.text+" "+str(OutCanvas.Width) + "x" +str(OutCanvas.Height) +".png"))
		  end
		  
		  If f <> Nil Then
		    OutCanvas.Save(f, Picture.SaveAsPNG)
		  End If
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SaveAsGrid
	#tag Event
		Sub Action()
		  Dim f As FolderItem
		  Dim d As SaveAsDialog
		  d = New SaveAsDialog
		  dim outpic as Picture
		  
		  
		  
		  if GridsList.ListIndex <> -1 then
		    
		    for i as integer=GridsList.listcount-1 downto 0
		      if GridsList.selected(i) then
		        PicIndex = i
		        BuildGrid(PicIndex)
		        f = GetSaveFolderItem(ImageFileTypeSet.Png, ("Grid-" +GridsList.Cell(PicIndex,6) + "-"+str(mypic.Width) + "x" +str(mypic.Height) +".png"))
		        
		        If f <> Nil Then
		          mypic.Save(f, Picture.SaveAsPNG)
		        End If
		        
		      end
		    next
		    
		    
		    
		  else
		    
		    for i as integer = 0 to GridsList.ListCount-1
		      PicIndex = i
		      BuildGrid(PicIndex)
		      
		      f = GetSaveFolderItem(ImageFileTypeSet.Png, ("Grid-" +GridsList.Cell(i,6) + "-"+str(myPic.Width) + "x" +str(myPic.Height) +".png"))
		      
		      If f <> Nil Then
		        mypic.Save(f, Picture.SaveAsPNG)
		      End If
		      
		    next
		  end
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Grid_Solo
	#tag Event
		Sub Action()
		  
		  UpdateScreen()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ColorPicker
	#tag Event
		Sub MouseUp(X As Integer, Y As Integer)
		  Dim c  As Color
		  Dim b as Boolean
		  c = ColorPicker.FillColor
		  'c=CMY(.35,.9,.6) //choose the default color shown in color picker
		  b=SelectColor(c,"Select a Color")
		  ColorPicker.FillColor=c
		  
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges col pick")
		  
		  
		  
		End Sub
	#tag EndEvent
	#tag Event
		Function MouseDown(X As Integer, Y As Integer) As Boolean
		  
		  return true
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events GridColour
	#tag Event
		Sub Action()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges grid colour")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events CanvasText
	#tag Event
		Function KeyDown(Key As String) As Boolean
		  If Asc(key) = 13 Or Asc(key) = 9 Then
		    UpdateScreen
		    app.newChanges = True
		    debugWindow.log("newChanges canvasText")
		  else
		    return false
		  end
		  
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events TextPos
	#tag Event
		Sub Change()
		  TP = Me.ListIndex
		  UpdateScreen
		  app.newChanges = True
		  debugWindow.log("newChanges text pos")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MaskMode
	#tag Event
		Sub Action()
		  UpdateScreen()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events AEexport
	#tag Event
		Sub Action()
		  
		  Dim n As Integer
		  n = MsgBox("Would you like to generate a script with the grids included?", 36)
		  If n = 6 Then
		    withGrids = true
		  ElseIf n = 7 Then
		    withGrids = false
		  End If
		  
		  AfterEffect(withGrids)
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events col_alpha
	#tag Event
		Sub Change()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges col alpha")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events T_Canvas
	#tag Event
		Sub Action()
		  'Preferences.Tcanvas = Me.value
		  
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges T-canvas")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events dropShadow
	#tag Event
		Sub Action()
		  UpdateScreen
		  
		  app.newChanges = True
		  debugWindow.log("newChanges ds")
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events updateTime
	#tag Event
		Sub Action()
		  app.StartCheck()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events FitHbutton
	#tag Event
		Sub Action()
		  FitH
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events OnetoOnebtn
	#tag Event
		Sub Action()
		  OnetoOne
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events FitVbutton
	#tag Event
		Sub Action()
		  FitV
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="BackColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="Color"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		Type="Picture"
		EditorType="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="CanvasHmargin"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="CanvasVMargin"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="CloseButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="column"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composite"
		Group="OS X (Carbon)"
		InitialValue="False"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="edit"
		Group="Behavior"
		InitialValue="false"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Frame"
		Visible=true
		Group="Frame"
		InitialValue="0"
		Type="Integer"
		EditorType="Enum"
		#tag EnumValues
			"0 - Document"
			"1 - Movable Modal"
			"2 - Modal Dialog"
			"3 - Floating Window"
			"4 - Plain Box"
			"5 - Shadowed Box"
			"6 - Rounded Window"
			"7 - Global Floating Window"
			"8 - Sheet Window"
			"9 - Metal Window"
			"11 - Modeless Dialog"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="FullScreen"
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="FullScreenButton"
		Visible=true
		Group="Frame"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="GorC"
		Group="Behavior"
		InitialValue="false"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="400"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="icon"
		Group="Behavior"
		Type="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="ImplicitInstance"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Interfaces"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LiveResize"
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MacProcID"
		Group="OS X (Carbon)"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaxHeight"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaxWidth"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="maxWinHeight"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="maxWinWidth"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBar"
		Visible=true
		Group="Menus"
		Type="MenuBar"
		EditorType="MenuBar"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBarVisible"
		Visible=true
		Group="Deprecated"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinHeight"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinWidth"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="mScale"
		Group="Behavior"
		InitialValue="75"
		Type="Double"
	#tag EndViewProperty
	#tag ViewProperty
		Name="myPic"
		Group="Behavior"
		Type="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="OutCanvas"
		Group="Behavior"
		Type="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="OutputIsOpen"
		Group="Behavior"
		InitialValue="false"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="PicIndex"
		Group="Behavior"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Placement"
		Visible=true
		Group="Behavior"
		InitialValue="0"
		Type="Integer"
		EditorType="Enum"
		#tag EnumValues
			"0 - Default"
			"1 - Parent Window"
			"2 - Main Screen"
			"3 - Parent Window Screen"
			"4 - Stagger"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="rebuild"
		Group="Behavior"
		InitialValue="true"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Resizeable"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="row"
		Group="Behavior"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Title"
		Visible=true
		Group="Frame"
		InitialValue="Untitled"
		Type="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TP"
		Group="Behavior"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="600"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="withGrids"
		Group="Behavior"
		InitialValue="false"
		Type="Boolean"
	#tag EndViewProperty
#tag EndViewBehavior
